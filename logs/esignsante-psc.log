2021-12-24 08:26:29,477 INFO org.springframework.boot.StartupInfoLogger [main] Starting DelegateMethodeInternalTest using Java 11.0.2 on NXQLX078 with PID 2604 (started by cjuillard in C:\Users\cjuillard\test\esignsantepsc)
2021-12-24 08:26:29,481 DEBUG org.springframework.boot.StartupInfoLogger [main] Running with Spring Boot v2.5.2, Spring v5.3.8
2021-12-24 08:26:29,484 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-12-24 08:26:32,340 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 08:26:32,404 INFO fr.ans.api.sign.esignsante.psc.config.MongoDBConfig [main] création d'une connexion à MongoDB avec   mongodb://localhost:27017 mongoDatabase: esignsante-psc
2021-12-24 08:26:32,450 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c57628405b2c3500e33b81', description='null'}-localhost:27017] Opened connection [connectionId{localValue:2, serverValue:2}] to localhost:27017
2021-12-24 08:26:32,450 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57628405b2c3500e33b81', description='null'}-localhost:27017] Opened connection [connectionId{localValue:1, serverValue:1}] to localhost:27017
2021-12-24 08:26:32,454 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57628405b2c3500e33b81', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=27036100}
2021-12-24 08:26:35,205 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 08:26:35,210 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c5762b405b2c3500e33b82', description='null'}-localhost:27017] Opened connection [connectionId{localValue:3, serverValue:3}] to localhost:27017
2021-12-24 08:26:35,211 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c5762b405b2c3500e33b82', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=1340400}
2021-12-24 08:26:35,213 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c5762b405b2c3500e33b82', description='null'}-localhost:27017] Opened connection [connectionId{localValue:4, serverValue:4}] to localhost:27017
2021-12-24 08:26:35,811 INFO org.springframework.boot.StartupInfoLogger [main] Started DelegateMethodeInternalTest in 6.888 seconds (JVM running for 9.226)
2021-12-24 08:26:35,952 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Requête en echec. Message retourné à l'utilisateur: Erreur dans la lecture du fichier reçu
2021-12-24 08:26:35,954 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] classe Exception: java.io.IOException
2021-12-24 08:26:35,955 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] cause de l'eException: {}
2021-12-24 08:26:35,955 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] message de l'exception null
2021-12-24 08:26:36,003 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Requête en echec. Message retourné à l'utilisateur: Erreur dans la lecture du fichier reçu
2021-12-24 08:26:36,004 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] classe Exception: java.io.IOException
2021-12-24 08:26:36,004 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] cause de l'eException: {}
2021-12-24 08:26:36,005 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] message de l'exception null
2021-12-24 08:26:36,051 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] signer: Délégataire de signature pour FamilyName (SubjectNameId)
2021-12-24 08:26:36,052 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] signer: Signé pour le compte de FamilyName (SubjectNameId)
2021-12-24 08:26:36,312 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Verification du fichier ipsfra.xml type detecté: application/xml
2021-12-24 08:26:36,312 DEBUG fr.ans.api.sign.esignsante.psc.api.DelegateMethodeTest [main] application/xml
2021-12-24 08:26:36,319 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Verification du fichier ANS.pdf type detecté: application/pdf
2021-12-24 08:26:36,322 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Verification du fichier empty.zzz type detecté: application/octet-stream
2021-12-24 08:26:36,325 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] java.io.FileNotFoundException: zzz (Le fichier spécifié est introuvable)
2021-12-24 08:26:36,326 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Requête en echec. Message retourné à l'utilisateur: Execption sur vérification du type de fichier transmis
2021-12-24 08:26:36,327 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] classe Exception: java.io.FileNotFoundException
2021-12-24 08:26:36,327 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] cause de l'eException: {}
2021-12-24 08:26:36,328 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] message de l'exception zzz (Le fichier spécifié est introuvable)
2021-12-24 08:26:36,340 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: ipsfra.xml. Use ipsfra.xml as name
2021-12-24 08:26:36,341 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile ipsfra.xml1498391601131260315.tmp
2021-12-24 08:26:36,343 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: ipsfra.xml1498391601131260315.tmp 	 length 2628
2021-12-24 08:26:36,350 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] retour appel esignsante OK pour un contrôle de signature - formatage de la réponse
2021-12-24 08:26:36,351 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] report false
2021-12-24 08:26:36,419 INFO org.springframework.boot.StartupInfoLogger [main] Starting AskApiIntegrationEsignWSOFFTest using Java 11.0.2 on NXQLX078 with PID 2604 (started by cjuillard in C:\Users\cjuillard\test\esignsantepsc)
2021-12-24 08:26:36,420 DEBUG org.springframework.boot.StartupInfoLogger [main] Running with Spring Boot v2.5.2, Spring v5.3.8
2021-12-24 08:26:36,421 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-12-24 08:26:37,045 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 08:26:37,047 INFO fr.ans.api.sign.esignsante.psc.config.MongoDBConfig [main] création d'une connexion à MongoDB avec   mongodb://localhost:27017 mongoDatabase: esignsante-psc
2021-12-24 08:26:37,050 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c5762d405b2c3500e33b83', description='null'}-localhost:27017] Opened connection [connectionId{localValue:6, serverValue:5}] to localhost:27017
2021-12-24 08:26:37,051 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c5762d405b2c3500e33b83', description='null'}-localhost:27017] Opened connection [connectionId{localValue:5, serverValue:6}] to localhost:27017
2021-12-24 08:26:37,051 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c5762d405b2c3500e33b83', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=2238800}
2021-12-24 08:26:38,079 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 08:26:38,084 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c5762e405b2c3500e33b84', description='null'}-localhost:27017] Opened connection [connectionId{localValue:8, serverValue:7}] to localhost:27017
2021-12-24 08:26:38,085 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c5762e405b2c3500e33b84', description='null'}-localhost:27017] Opened connection [connectionId{localValue:7, serverValue:8}] to localhost:27017
2021-12-24 08:26:38,085 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c5762e405b2c3500e33b84', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=2140200}
2021-12-24 08:26:38,362 INFO org.springframework.boot.StartupInfoLogger [main] Started AskApiIntegrationEsignWSOFFTest in 1.976 seconds (JVM running for 11.777)
2021-12-24 08:26:38,484 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Réception d'une demande de signature Xades
2021-12-24 08:26:38,489 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
}
2021-12-24 08:26:38,504 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  200 OK
2021-12-24 08:26:38,505 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel PSC intropesction: token= accessTokenValue  reponse PSC = {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-24 08:26:38,507 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: ipsfra.xml. Use ipsfra.xml as name
2021-12-24 08:26:38,508 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile ipsfra.xml8489199110867481314.tmp
2021-12-24 08:26:38,510 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: ipsfra.xml8489199110867481314.tmp 	 length 2628
2021-12-24 08:26:38,567 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Verification du fichier ipsfra.xml8489199110867481314.tmp type detecté: text/plain
2021-12-24 08:26:38,568 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Demande de signature valide: verif AccessToken OK: {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
, File OK ipsfra.xml8489199110867481314.tmp 
, userInfo OK Organisation: CABINET M SPECIALISTE0021889
2021-12-24 08:26:38,569 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] openidtoken[0] transmis à esignWS:
2021-12-24 08:26:38,569 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 userinfo (base64): eyJTZWN0ZXVyX0FjdGl2aXRlIjoiU0EwN14xLjIuMjUwLjEuNzEuNC4yLjQiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIlN1YmplY3RPcmdhbml6YXRpb24iOiJDQUJJTkVUIE0gU1BFQ0lBTElTVEUwMDIxODg5IiwicHJlZmVycmVkX3VzZXJuYW1lIjoiODk5NzAwMjE4ODk2IiwiZ2l2ZW5fbmFtZSI6IlJPQkVSVCIsIlN1YmplY3RSZWZQcm8iOnsiY29kZUNpdmlsaXRlIjoiTSIsImV4ZXJjaWNlcyI6W3siY29kZVByb2Zlc3Npb24iOiIxMCIsIm5vbURleGVyY2ljZSI6IlNQRUNJQUxJU1RFMDAyMTg4OSIsInByZW5vbURleGVyY2ljZSI6IlJPQkVSVCIsImNvZGVUeXBlU2F2b2lyRmFpcmUiOiIifV19LCJTdWJqZWN0Um9sZSI6WyIxMF4xLjIuMjUwLjEuMjEzLjEuMS41LjUiXSwiU3ViamVjdE5hbWVJRCI6Ijg5OTcwMDIxODg5NiIsImZhbWlseV9uYW1lIjoiU1BFQ0lBTElTVEUwMDIxODg5In0= 
2021-12-24 08:26:38,570 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 accessToken: accessTokenValue 
2021-12-24 08:26:38,571 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 PSCResponse: {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-24 08:26:38,571 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] signer: Délégataire de signature pour SPECIALISTE0021889 (899700218896)
2021-12-24 08:26:38,572 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel esignWS pour une signature de type XADES
2021-12-24 08:26:38,596 INFO fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] Appel esignante Webservices pour basePath = http://localhost:8081/esignsante/v1
2021-12-24 08:26:38,596 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] appel esignsanteWebservices pour une demande de signature en xades 
2021-12-24 08:26:38,597 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] fileToSign: ipsfra.xml8489199110867481314.tmp
2021-12-24 08:26:38,599 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] paramètres: basePath: http://localhost:8081/esignsante/v1 
 idSignConf: 1 
 proofConfId: 1 

2021-12-24 08:26:40,695 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Requête en echec. Message retourné à l'utilisateur: Exception sur appel esignWS. Service inaccessible
2021-12-24 08:26:40,696 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] classe Exception: org.springframework.web.client.ResourceAccessException
2021-12-24 08:26:40,700 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] cause de l'eException: {}
java.net.ConnectException: Connection refused: connect
	at java.base/java.net.PlainSocketImpl.connect0(Native Method)
	at java.base/java.net.PlainSocketImpl.socketConnect(PlainSocketImpl.java:101)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:399)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:242)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:224)
	at java.base/java.net.Socket.connect(Socket.java:591)
	at java.base/java.net.Socket.connect(Socket.java:540)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:182)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:474)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:569)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:242)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:341)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:362)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1242)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1181)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1075)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1009)
	at org.springframework.http.client.SimpleBufferingClientHttpRequest.executeInternal(SimpleBufferingClientHttpRequest.java:76)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.http.client.BufferingClientHttpRequestWrapper.executeInternal(BufferingClientHttpRequestWrapper.java:63)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:776)
	at org.springframework.web.client.RestTemplate.exchange(RestTemplate.java:670)
	at fr.ans.esignsante.ApiClient.invokeAPI(ApiClient.java:526)
	at fr.ans.esignsante.api.XadesApi.signatureXadesWithProof(XadesApi.java:207)
	at fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall.signatureXades(EsignsanteCall.java:56)
	at fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl.executeAskSignature(AsksignatureApiDelegateImpl.java:288)
	at fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl.postAsksignatureXades(AsksignatureApiDelegateImpl.java:129)
	at fr.ans.api.sign.esignsante.psc.api.AsksignatureApi.postAsksignatureXades(AsksignatureApi.java:91)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:894)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1063)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:681)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at org.springframework.test.web.servlet.TestDispatcherServlet.service(TestDispatcherServlet.java:72)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
	at org.springframework.mock.web.MockFilterChain$ServletFilterProxy.doFilter(MockFilterChain.java:167)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:134)
	at org.springframework.test.web.servlet.MockMvc.perform(MockMvc.java:183)
	at fr.ans.api.sign.esignsante.psc.api.requests.AskApiIntegrationEsignWSOFFTest.askSignXADES_esignWS_OFFTest(AskApiIntegrationEsignWSOFFTest.java:93)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:688)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:140)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:84)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$6(TestMethodTestDescriptor.java:210)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:206)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:131)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:65)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1540)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1540)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:32)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:51)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:220)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$6(DefaultLauncher.java:188)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:202)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:181)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:128)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:150)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2021-12-24 08:26:40,702 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] message de l'exception I/O error on POST request for "http://localhost:8081/esignsante/v1/signatures/xadesbaselinebwithproof": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect
2021-12-24 08:26:40,804 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Réception d'une demande de signature Pades
2021-12-24 08:26:40,806 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
}
2021-12-24 08:26:40,807 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  200 OK
2021-12-24 08:26:40,808 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel PSC intropesction: token= accessTokenValue  reponse PSC = {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-24 08:26:40,809 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: ANS.pdf. Use ANS.pdf as name
2021-12-24 08:26:40,810 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile ANS.pdf7429540287699482927.tmp
2021-12-24 08:26:40,812 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: ANS.pdf7429540287699482927.tmp 	 length 97996
2021-12-24 08:26:40,848 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Verification du fichier ANS.pdf7429540287699482927.tmp type detecté: application/pdf
2021-12-24 08:26:40,849 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Demande de signature valide: verif AccessToken OK: {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
, File OK ANS.pdf7429540287699482927.tmp 
, userInfo OK Organisation: CABINET M SPECIALISTE0021889
2021-12-24 08:26:40,850 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] openidtoken[0] transmis à esignWS:
2021-12-24 08:26:40,850 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 userinfo (base64): eyJTZWN0ZXVyX0FjdGl2aXRlIjoiU0EwN14xLjIuMjUwLjEuNzEuNC4yLjQiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIlN1YmplY3RPcmdhbml6YXRpb24iOiJDQUJJTkVUIE0gU1BFQ0lBTElTVEUwMDIxODg5IiwicHJlZmVycmVkX3VzZXJuYW1lIjoiODk5NzAwMjE4ODk2IiwiZ2l2ZW5fbmFtZSI6IlJPQkVSVCIsIlN1YmplY3RSZWZQcm8iOnsiY29kZUNpdmlsaXRlIjoiTSIsImV4ZXJjaWNlcyI6W3siY29kZVByb2Zlc3Npb24iOiIxMCIsIm5vbURleGVyY2ljZSI6IlNQRUNJQUxJU1RFMDAyMTg4OSIsInByZW5vbURleGVyY2ljZSI6IlJPQkVSVCIsImNvZGVUeXBlU2F2b2lyRmFpcmUiOiIifV19LCJTdWJqZWN0Um9sZSI6WyIxMF4xLjIuMjUwLjEuMjEzLjEuMS41LjUiXSwiU3ViamVjdE5hbWVJRCI6Ijg5OTcwMDIxODg5NiIsImZhbWlseV9uYW1lIjoiU1BFQ0lBTElTVEUwMDIxODg5In0= 
2021-12-24 08:26:40,851 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 accessToken: accessTokenValue 
2021-12-24 08:26:40,851 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 PSCResponse: {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-24 08:26:40,852 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] signer: Signé pour le compte de SPECIALISTE0021889 (899700218896)
2021-12-24 08:26:40,852 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel esignWS pour une signature de type PADES
2021-12-24 08:26:40,859 INFO fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] Appel esignante Webservices pour basePath = http://localhost:8081/esignsante/v1
2021-12-24 08:26:40,860 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] appel esignsanteWebservices pour une demande de signature en PADES 
2021-12-24 08:26:40,861 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] fileToSign: ANS.pdf7429540287699482927.tmp
2021-12-24 08:26:40,864 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] paramètres: basePath: http://localhost:8081/esignsante/v1 
 idSignConf: 1 
 proofConfId: 1 

2021-12-24 08:26:42,899 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Requête en echec. Message retourné à l'utilisateur: Exception sur appel esignWS. Service inaccessible
2021-12-24 08:26:42,901 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] classe Exception: org.springframework.web.client.ResourceAccessException
2021-12-24 08:26:42,903 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] cause de l'eException: {}
java.net.ConnectException: Connection refused: connect
	at java.base/java.net.PlainSocketImpl.connect0(Native Method)
	at java.base/java.net.PlainSocketImpl.socketConnect(PlainSocketImpl.java:101)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:399)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:242)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:224)
	at java.base/java.net.Socket.connect(Socket.java:591)
	at java.base/java.net.Socket.connect(Socket.java:540)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:182)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:474)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:569)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:242)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:341)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:362)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1242)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1181)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1075)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1009)
	at org.springframework.http.client.SimpleBufferingClientHttpRequest.executeInternal(SimpleBufferingClientHttpRequest.java:76)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.http.client.BufferingClientHttpRequestWrapper.executeInternal(BufferingClientHttpRequestWrapper.java:63)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:776)
	at org.springframework.web.client.RestTemplate.exchange(RestTemplate.java:670)
	at fr.ans.esignsante.ApiClient.invokeAPI(ApiClient.java:526)
	at fr.ans.esignsante.api.PadesApi.signaturePadesWithProof(PadesApi.java:207)
	at fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall.signaturePades(EsignsanteCall.java:77)
	at fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl.executeAskSignature(AsksignatureApiDelegateImpl.java:286)
	at fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl.postAskSignaturePades(AsksignatureApiDelegateImpl.java:92)
	at fr.ans.api.sign.esignsante.psc.api.AsksignatureApi.postAskSignaturePades(AsksignatureApi.java:58)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:894)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1063)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:681)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at org.springframework.test.web.servlet.TestDispatcherServlet.service(TestDispatcherServlet.java:72)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
	at org.springframework.mock.web.MockFilterChain$ServletFilterProxy.doFilter(MockFilterChain.java:167)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:134)
	at org.springframework.test.web.servlet.MockMvc.perform(MockMvc.java:183)
	at fr.ans.api.sign.esignsante.psc.api.requests.AskApiIntegrationEsignWSOFFTest.askSignPADES_esignWS_OFFTest(AskApiIntegrationEsignWSOFFTest.java:130)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:688)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:140)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:84)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$6(TestMethodTestDescriptor.java:210)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:206)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:131)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:65)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1540)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1540)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:32)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:51)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:220)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$6(DefaultLauncher.java:188)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:202)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:181)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:128)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:150)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2021-12-24 08:26:42,907 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] message de l'exception I/O error on POST request for "http://localhost:8081/esignsante/v1/signatures/padesbaselinebwithproof": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect
2021-12-24 08:26:43,000 INFO org.springframework.boot.StartupInfoLogger [main] Starting AskApiIntegrationTest using Java 11.0.2 on NXQLX078 with PID 2604 (started by cjuillard in C:\Users\cjuillard\test\esignsantepsc)
2021-12-24 08:26:43,001 DEBUG org.springframework.boot.StartupInfoLogger [main] Running with Spring Boot v2.5.2, Spring v5.3.8
2021-12-24 08:26:43,002 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-12-24 08:26:43,590 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 08:26:43,592 INFO fr.ans.api.sign.esignsante.psc.config.MongoDBConfig [main] création d'une connexion à MongoDB avec   mongodb://localhost:27017 mongoDatabase: esignsante-psc
2021-12-24 08:26:43,597 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c57633405b2c3500e33b85', description='null'}-localhost:27017] Opened connection [connectionId{localValue:10, serverValue:9}] to localhost:27017
2021-12-24 08:26:43,598 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57633405b2c3500e33b85', description='null'}-localhost:27017] Opened connection [connectionId{localValue:9, serverValue:10}] to localhost:27017
2021-12-24 08:26:43,599 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57633405b2c3500e33b85', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=4696400}
2021-12-24 08:26:44,556 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 08:26:44,560 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57634405b2c3500e33b86', description='null'}-localhost:27017] Opened connection [connectionId{localValue:11, serverValue:11}] to localhost:27017
2021-12-24 08:26:44,560 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c57634405b2c3500e33b86', description='null'}-localhost:27017] Opened connection [connectionId{localValue:12, serverValue:12}] to localhost:27017
2021-12-24 08:26:44,561 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57634405b2c3500e33b86', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=1125000}
2021-12-24 08:26:44,792 INFO org.springframework.boot.StartupInfoLogger [main] Started AskApiIntegrationTest in 1.816 seconds (JVM running for 18.208)
2021-12-24 08:26:44,807 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Réception d'une demande de signature Pades
2021-12-24 08:26:44,808 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
}
2021-12-24 08:26:44,809 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  200 OK
2021-12-24 08:26:44,810 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel PSC intropesction: token= accessTokenValue  reponse PSC = {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-24 08:26:44,812 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: ipsfra.xml. Use ipsfra.xml as name
2021-12-24 08:26:44,813 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile ipsfra.xml2245883397966044090.tmp
2021-12-24 08:26:44,814 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: ipsfra.xml2245883397966044090.tmp 	 length 2628
2021-12-24 08:26:44,827 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Verification du fichier ipsfra.xml2245883397966044090.tmp type detecté: text/plain
2021-12-24 08:26:44,874 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Réception d'une demande de signature Xades
2021-12-24 08:26:44,875 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
}
2021-12-24 08:26:44,876 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  200 OK
2021-12-24 08:26:44,877 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel PSC intropesction: token= accessTokenValue  reponse PSC = {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-24 08:26:44,878 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: ipsfra.xml. Use ipsfra.xml as name
2021-12-24 08:26:44,879 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile ipsfra.xml3543344539169974934.tmp
2021-12-24 08:26:44,881 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: ipsfra.xml3543344539169974934.tmp 	 length 2628
2021-12-24 08:26:44,891 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Verification du fichier ipsfra.xml3543344539169974934.tmp type detecté: text/plain
2021-12-24 08:26:44,891 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Demande de signature valide: verif AccessToken OK: {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
, File OK ipsfra.xml3543344539169974934.tmp 
, userInfo OK Organisation: CABINET M SPECIALISTE0021889
2021-12-24 08:26:44,891 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] openidtoken[0] transmis à esignWS:
2021-12-24 08:26:44,892 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 userinfo (base64): eyJTZWN0ZXVyX0FjdGl2aXRlIjoiU0EwN14xLjIuMjUwLjEuNzEuNC4yLjQiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIlN1YmplY3RPcmdhbml6YXRpb24iOiJDQUJJTkVUIE0gU1BFQ0lBTElTVEUwMDIxODg5IiwicHJlZmVycmVkX3VzZXJuYW1lIjoiODk5NzAwMjE4ODk2IiwiZ2l2ZW5fbmFtZSI6IlJPQkVSVCIsIlN1YmplY3RSZWZQcm8iOnsiY29kZUNpdmlsaXRlIjoiTSIsImV4ZXJjaWNlcyI6W3siY29kZVByb2Zlc3Npb24iOiIxMCIsIm5vbURleGVyY2ljZSI6IlNQRUNJQUxJU1RFMDAyMTg4OSIsInByZW5vbURleGVyY2ljZSI6IlJPQkVSVCIsImNvZGVUeXBlU2F2b2lyRmFpcmUiOiIifV19LCJTdWJqZWN0Um9sZSI6WyIxMF4xLjIuMjUwLjEuMjEzLjEuMS41LjUiXSwiU3ViamVjdE5hbWVJRCI6Ijg5OTcwMDIxODg5NiIsImZhbWlseV9uYW1lIjoiU1BFQ0lBTElTVEUwMDIxODg5In0= 
2021-12-24 08:26:44,893 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 accessToken: accessTokenValue 
2021-12-24 08:26:44,894 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 PSCResponse: {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-24 08:26:44,894 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] signer: Délégataire de signature pour SPECIALISTE0021889 (899700218896)
2021-12-24 08:26:44,895 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel esignWS pour une signature de type XADES
2021-12-24 08:26:44,896 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main]  START archivage de la preuve en BDD pour request id: 51e823aa-f2ec-4fad-bba5-38751bb58bc6
2021-12-24 08:26:44,897 DEBUG fr.ans.api.sign.esignsante.psc.storage.repository.PreuveDAOImpl [main] demande persistence de la preuve d'une demande de signature pour: 
  SubjectOrganization: CABINET M SPECIALISTE0021889 
  Preferred_username: 899700218896 
 Given_name: ROBERT 
Family_name:SPECIALISTE0021889  
 Timestamp (acceptation de la reqête): Fri Dec 24 08:26:44 CET 2021   
2021-12-24 08:26:44,962 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Opened connection [connectionId{localValue:13, serverValue:13}] to localhost:27017
2021-12-24 08:26:45,008 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Fin archivage de la preuve en BDD pour request id: 51e823aa-f2ec-4fad-bba5-38751bb58bc6
2021-12-24 08:26:45,072 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Réception d'une demande de signature Pades
2021-12-24 08:26:45,073 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {
    "active": false
}
2021-12-24 08:26:45,074 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  401 UNAUTHORIZED
2021-12-24 08:26:45,075 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel PSC intropesction: token= accessTokenValue  reponse PSC = {
    "active": false
} 
2021-12-24 08:26:45,104 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Réception d'une demande de signature Xades
2021-12-24 08:26:45,105 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {
    "active": false
}
2021-12-24 08:26:45,106 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  401 UNAUTHORIZED
2021-12-24 08:26:45,106 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel PSC intropesction: token= accessTokenValue  reponse PSC = {
    "active": false
} 
2021-12-24 08:26:45,132 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Réception d'une demande de signature Pades
2021-12-24 08:26:45,133 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
}
2021-12-24 08:26:45,134 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  200 OK
2021-12-24 08:26:45,135 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel PSC intropesction: token= accessTokenValue  reponse PSC = {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-24 08:26:45,136 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: ANS.pdf. Use ANS.pdf as name
2021-12-24 08:26:45,136 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile ANS.pdf13855176644192015215.tmp
2021-12-24 08:26:45,138 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: ANS.pdf13855176644192015215.tmp 	 length 97996
2021-12-24 08:26:45,172 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Verification du fichier ANS.pdf13855176644192015215.tmp type detecté: application/pdf
2021-12-24 08:26:45,173 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Demande de signature valide: verif AccessToken OK: {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
, File OK ANS.pdf13855176644192015215.tmp 
, userInfo OK Organisation: CABINET M SPECIALISTE0021889
2021-12-24 08:26:45,173 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] openidtoken[0] transmis à esignWS:
2021-12-24 08:26:45,174 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 userinfo (base64): eyJTZWN0ZXVyX0FjdGl2aXRlIjoiU0EwN14xLjIuMjUwLjEuNzEuNC4yLjQiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIlN1YmplY3RPcmdhbml6YXRpb24iOiJDQUJJTkVUIE0gU1BFQ0lBTElTVEUwMDIxODg5IiwicHJlZmVycmVkX3VzZXJuYW1lIjoiODk5NzAwMjE4ODk2IiwiZ2l2ZW5fbmFtZSI6IlJPQkVSVCIsIlN1YmplY3RSZWZQcm8iOnsiY29kZUNpdmlsaXRlIjoiTSIsImV4ZXJjaWNlcyI6W3siY29kZVByb2Zlc3Npb24iOiIxMCIsIm5vbURleGVyY2ljZSI6IlNQRUNJQUxJU1RFMDAyMTg4OSIsInByZW5vbURleGVyY2ljZSI6IlJPQkVSVCIsImNvZGVUeXBlU2F2b2lyRmFpcmUiOiIifV19LCJTdWJqZWN0Um9sZSI6WyIxMF4xLjIuMjUwLjEuMjEzLjEuMS41LjUiXSwiU3ViamVjdE5hbWVJRCI6Ijg5OTcwMDIxODg5NiIsImZhbWlseV9uYW1lIjoiU1BFQ0lBTElTVEUwMDIxODg5In0= 
2021-12-24 08:26:45,174 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 accessToken: accessTokenValue 
2021-12-24 08:26:45,174 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 PSCResponse: {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-24 08:26:45,175 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] signer: Signé pour le compte de SPECIALISTE0021889 (899700218896)
2021-12-24 08:26:45,175 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel esignWS pour une signature de type PADES
2021-12-24 08:26:45,175 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main]  START archivage de la preuve en BDD pour request id: 6e4adea2-eceb-4701-96e0-3cc7f2b6be3f
2021-12-24 08:26:45,176 DEBUG fr.ans.api.sign.esignsante.psc.storage.repository.PreuveDAOImpl [main] demande persistence de la preuve d'une demande de signature pour: 
  SubjectOrganization: CABINET M SPECIALISTE0021889 
  Preferred_username: 899700218896 
 Given_name: ROBERT 
Family_name:SPECIALISTE0021889  
 Timestamp (acceptation de la reqête): Fri Dec 24 08:26:45 CET 2021   
2021-12-24 08:26:45,179 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Fin archivage de la preuve en BDD pour request id: 6e4adea2-eceb-4701-96e0-3cc7f2b6be3f
2021-12-24 08:26:45,214 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Réception d'une demande des CAs
2021-12-24 08:26:45,220 INFO fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] Appel esignante Webservices pour basePath = http://localhost:8081/esignsante/v1
2021-12-24 08:26:47,254 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Requête en echec. Message retourné à l'utilisateur: Exception sur appel esignWS. Service inaccessible
2021-12-24 08:26:47,256 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] classe Exception: org.springframework.web.client.ResourceAccessException
2021-12-24 08:26:47,258 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] cause de l'eException: {}
java.net.ConnectException: Connection refused: connect
	at java.base/java.net.PlainSocketImpl.connect0(Native Method)
	at java.base/java.net.PlainSocketImpl.socketConnect(PlainSocketImpl.java:101)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:399)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:242)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:224)
	at java.base/java.net.Socket.connect(Socket.java:591)
	at java.base/java.net.Socket.connect(Socket.java:540)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:182)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:474)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:569)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:242)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:341)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:362)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1242)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1181)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1075)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1009)
	at org.springframework.http.client.SimpleBufferingClientHttpRequest.executeInternal(SimpleBufferingClientHttpRequest.java:76)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.http.client.BufferingClientHttpRequestWrapper.executeInternal(BufferingClientHttpRequestWrapper.java:63)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:776)
	at org.springframework.web.client.RestTemplate.exchange(RestTemplate.java:670)
	at fr.ans.esignsante.ApiClient.invokeAPI(ApiClient.java:526)
	at fr.ans.esignsante.api.CaApi.getCA(CaApi.java:73)
	at fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall.getCA(EsignsanteCall.java:124)
	at fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl.getCa(CaApiDelegateImpl.java:40)
	at fr.ans.api.sign.esignsante.psc.api.CaApi.getCa(CaApi.java:46)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:894)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1063)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:655)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at org.springframework.test.web.servlet.TestDispatcherServlet.service(TestDispatcherServlet.java:72)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
	at org.springframework.mock.web.MockFilterChain$ServletFilterProxy.doFilter(MockFilterChain.java:167)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:134)
	at org.springframework.test.web.servlet.MockMvc.perform(MockMvc.java:183)
	at fr.ans.api.sign.esignsante.psc.api.requests.CAApiIntegrationEsignWSOFFTest.caGet_esignWS_OFFTest(CAApiIntegrationEsignWSOFFTest.java:52)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:688)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:140)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:84)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$6(TestMethodTestDescriptor.java:210)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:206)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:131)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:65)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1540)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1540)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:32)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:51)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:220)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$6(DefaultLauncher.java:188)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:202)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:181)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:128)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:150)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2021-12-24 08:26:47,262 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] message de l'exception I/O error on GET request for "http://localhost:8081/esignsante/v1/ca": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect
2021-12-24 08:26:47,347 INFO org.springframework.boot.StartupInfoLogger [main] Starting CAApiIntegrationTest using Java 11.0.2 on NXQLX078 with PID 2604 (started by cjuillard in C:\Users\cjuillard\test\esignsantepsc)
2021-12-24 08:26:47,348 DEBUG org.springframework.boot.StartupInfoLogger [main] Running with Spring Boot v2.5.2, Spring v5.3.8
2021-12-24 08:26:47,349 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-12-24 08:26:47,854 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 08:26:47,856 INFO fr.ans.api.sign.esignsante.psc.config.MongoDBConfig [main] création d'une connexion à MongoDB avec   mongodb://localhost:27017 mongoDatabase: esignsante-psc
2021-12-24 08:26:47,858 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57637405b2c3500e33b89', description='null'}-localhost:27017] Opened connection [connectionId{localValue:14, serverValue:14}] to localhost:27017
2021-12-24 08:26:47,859 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57637405b2c3500e33b89', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=810200}
2021-12-24 08:26:47,860 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c57637405b2c3500e33b89', description='null'}-localhost:27017] Opened connection [connectionId{localValue:15, serverValue:15}] to localhost:27017
2021-12-24 08:26:48,745 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 08:26:48,751 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57638405b2c3500e33b8a', description='null'}-localhost:27017] Opened connection [connectionId{localValue:16, serverValue:16}] to localhost:27017
2021-12-24 08:26:48,751 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57638405b2c3500e33b8a', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=1526500}
2021-12-24 08:26:48,753 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c57638405b2c3500e33b8a', description='null'}-localhost:27017] Opened connection [connectionId{localValue:17, serverValue:17}] to localhost:27017
2021-12-24 08:26:48,995 INFO org.springframework.boot.StartupInfoLogger [main] Started CAApiIntegrationTest in 1.68 seconds (JVM running for 22.41)
2021-12-24 08:26:49,024 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Réception d'une demande des CAs
2021-12-24 08:26:49,025 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Demande des CAs traitée avec succès
2021-12-24 08:26:49,046 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Réception d'une demande des CAs
2021-12-24 08:26:49,047 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Demande des CAs traitée avec succès
2021-12-24 08:26:49,050 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Réception d'une demande des CAs
2021-12-24 08:26:49,051 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Demande des CAs traitée avec succès
2021-12-24 08:26:49,054 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Réception d'une demande des CAs
2021-12-24 08:26:49,055 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Demande des CAs traitée avec succès
2021-12-24 08:26:49,062 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Réception d'une demande des CAs
2021-12-24 08:26:49,063 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Demande des CAs traitée avec succès
2021-12-24 08:26:49,081 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Réception d'une demande des CAs
2021-12-24 08:26:49,082 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Demande des CAs traitée avec succès
2021-12-24 08:26:49,109 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Demande Checksignature Pades reçue
2021-12-24 08:26:49,110 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: signedipsfra.xml. Use signedipsfra.xml as name
2021-12-24 08:26:49,111 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile signedipsfra.xml6849318822871223346.tmp
2021-12-24 08:26:49,112 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: signedipsfra.xml6849318822871223346.tmp 	 length 10239
2021-12-24 08:26:49,113 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] message 501 501 

2021-12-24 08:26:49,113 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] toString org.springframework.web.client.HttpServerErrorException$NotImplemented: 501 501 

2021-12-24 08:26:49,114 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] class Name org.springframework.web.client.HttpServerErrorException$NotImplemented 

2021-12-24 08:26:49,115 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] class Canonicalname org.springframework.web.client.HttpServerErrorException.NotImplemented 

2021-12-24 08:26:49,115 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Echec de l'appel à esignsanteWS => HttpServerErrorException.NotImplemented
2021-12-24 08:26:49,139 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Réception d'une demande Checksignature Pades.
2021-12-24 08:26:49,140 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: ANS_SIGNED.pdf. Use ANS_SIGNED.pdf as name
2021-12-24 08:26:49,141 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile ANS_SIGNED.pdf17181988403016640869.tmp
2021-12-24 08:26:49,143 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: ANS_SIGNED.pdf17181988403016640869.tmp 	 length 118076
2021-12-24 08:26:49,144 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] message 501 501 

2021-12-24 08:26:49,145 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] toString org.springframework.web.client.HttpServerErrorException$NotImplemented: 501 501 

2021-12-24 08:26:49,146 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] class Name org.springframework.web.client.HttpServerErrorException$NotImplemented 

2021-12-24 08:26:49,146 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] class Canonicalname org.springframework.web.client.HttpServerErrorException.NotImplemented 

2021-12-24 08:26:49,147 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Echec de l'appel à esignsanteWS => HttpServerErrorException.NotImplemented
2021-12-24 08:26:49,191 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Réception d'une demande Checksignature Pades.
2021-12-24 08:26:49,192 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: . Use  as name
2021-12-24 08:26:49,192 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile 2697912324926681314.tmp
2021-12-24 08:26:49,194 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: 2697912324926681314.tmp 	 length 32158
2021-12-24 08:26:49,200 INFO fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] Appel esignante Webservices pour basePath = http://localhost:8081/esignsante/v1
2021-12-24 08:26:49,201 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] appel esignsanteWebservices pour une VERIF de signature en xades
2021-12-24 08:26:49,212 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] paramètres: basePath: http://localhost:8081/esignsante/v1 id checkSign d esignsante: 1 file: 2697912324926681314.tmp
2021-12-24 08:26:49,213 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] fileExist:true
2021-12-24 08:26:51,232 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] message I/O error on POST request for "http://localhost:8081/esignsante/v1/validation/signatures/xadesbaselineb": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect 

2021-12-24 08:26:51,232 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] toString org.springframework.web.client.ResourceAccessException: I/O error on POST request for "http://localhost:8081/esignsante/v1/validation/signatures/xadesbaselineb": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect 

2021-12-24 08:26:51,233 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] class Name org.springframework.web.client.ResourceAccessException 

2021-12-24 08:26:51,233 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] class Canonicalname org.springframework.web.client.ResourceAccessException 

2021-12-24 08:26:51,233 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Exception sur appel esignWS. Service inaccessible
2021-12-24 08:26:51,265 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Demande Checksignature Pades reçue
2021-12-24 08:26:51,266 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: . Use  as name
2021-12-24 08:26:51,266 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile 12160616034425183082.tmp
2021-12-24 08:26:51,267 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: 12160616034425183082.tmp 	 length 118076
2021-12-24 08:26:51,272 INFO fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] Appel esignante Webservices pour basePath = http://localhost:8081/esignsante/v1
2021-12-24 08:26:51,272 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] appel esignsanteWebservices pour une VERIF de signature en PADES
2021-12-24 08:26:51,273 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] paramètres: basePath: http://localhost:8081/esignsante/v1 id checkSign d esignsante: 1 file: 12160616034425183082.tmp
2021-12-24 08:26:51,273 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] fileExist:true
2021-12-24 08:26:53,330 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] message I/O error on POST request for "http://localhost:8081/esignsante/v1/validation/signatures/padesbaselineb": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect 

2021-12-24 08:26:53,332 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] toString org.springframework.web.client.ResourceAccessException: I/O error on POST request for "http://localhost:8081/esignsante/v1/validation/signatures/padesbaselineb": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect 

2021-12-24 08:26:53,333 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] class Name org.springframework.web.client.ResourceAccessException 

2021-12-24 08:26:53,334 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] class Canonicalname org.springframework.web.client.ResourceAccessException 

2021-12-24 08:26:53,335 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Exception sur appel esignWS. Service inaccessible
2021-12-24 08:26:53,432 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Demande Checksignature Pades reçue
2021-12-24 08:26:53,433 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: ANS_SIGNED.pdf. Use ANS_SIGNED.pdf as name
2021-12-24 08:26:53,434 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile ANS_SIGNED.pdf5306190514377901756.tmp
2021-12-24 08:26:53,435 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: ANS_SIGNED.pdf5306190514377901756.tmp 	 length 118076
2021-12-24 08:26:53,436 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] retour appel esignsante OK pour un contrôle de signature - formatage de la réponse
2021-12-24 08:26:53,437 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] report true
2021-12-24 08:26:53,458 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Réception d'une demande Checksignature Pades.
2021-12-24 08:26:53,459 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: signedipsfra.xml. Use signedipsfra.xml as name
2021-12-24 08:26:53,460 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile signedipsfra.xml11897185305030114127.tmp
2021-12-24 08:26:53,462 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: signedipsfra.xml11897185305030114127.tmp 	 length 10239
2021-12-24 08:26:53,463 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] retour appel esignsante OK pour un contrôle de signature - formatage de la réponse
2021-12-24 08:26:53,464 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] report true
2021-12-24 08:26:53,488 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.DefaultApiDelegateImpl [main] Réception d'une demande des opérations disponibles
2021-12-24 08:26:53,512 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.DefaultApiDelegateImpl [main] Réception d'une demande des opérations disponibles
2021-12-24 08:26:53,555 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.DefaultApiDelegateImpl [main] Réception d'une demande des opérations disponibles
2021-12-24 08:26:53,606 INFO org.springframework.boot.StartupInfoLogger [main] Starting HelperTest using Java 11.0.2 on NXQLX078 with PID 2604 (started by cjuillard in C:\Users\cjuillard\test\esignsantepsc)
2021-12-24 08:26:53,606 DEBUG org.springframework.boot.StartupInfoLogger [main] Running with Spring Boot v2.5.2, Spring v5.3.8
2021-12-24 08:26:53,607 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-12-24 08:26:54,053 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 08:26:54,054 INFO fr.ans.api.sign.esignsante.psc.config.MongoDBConfig [main] création d'une connexion à MongoDB avec   mongodb://localhost:27017 mongoDatabase: esignsante-psc
2021-12-24 08:26:54,058 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c5763e405b2c3500e33b8b', description='null'}-localhost:27017] Opened connection [connectionId{localValue:18, serverValue:18}] to localhost:27017
2021-12-24 08:26:54,058 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c5763e405b2c3500e33b8b', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=1397700}
2021-12-24 08:26:54,059 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c5763e405b2c3500e33b8b', description='null'}-localhost:27017] Opened connection [connectionId{localValue:19, serverValue:19}] to localhost:27017
2021-12-24 08:26:54,892 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 08:26:54,896 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c5763e405b2c3500e33b8c', description='null'}-localhost:27017] Opened connection [connectionId{localValue:21, serverValue:21}] to localhost:27017
2021-12-24 08:26:54,896 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c5763e405b2c3500e33b8c', description='null'}-localhost:27017] Opened connection [connectionId{localValue:20, serverValue:20}] to localhost:27017
2021-12-24 08:26:54,897 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c5763e405b2c3500e33b8c', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=869300}
2021-12-24 08:26:55,090 INFO org.springframework.boot.StartupInfoLogger [main] Started HelperTest in 1.51 seconds (JVM running for 28.505)
2021-12-24 08:26:55,098 DEBUG fr.ans.api.sign.esignsante.psc.api.utils.HelperTest [main] encodebase64
2021-12-24 08:26:55,098 DEBUG fr.ans.api.sign.esignsante.psc.api.utils.HelperTest [main] Q2hhw65uZSBkZSBjYXJhY3TDqHJlIFVURjggJsOpIigsOyE=
2021-12-24 08:26:55,105 DEBUG fr.ans.api.sign.esignsante.psc.api.utils.HelperTest [main] test conversion Erreur(esignsante) en Error (esigsante-psc
2021-12-24 08:26:55,106 DEBUG fr.ans.api.sign.esignsante.psc.api.utils.HelperTest [main] code :codeErreur1 msg :message1
2021-12-24 08:26:55,106 DEBUG fr.ans.api.sign.esignsante.psc.api.utils.HelperTest [main] code :codeErreur2 msg :message2
2021-12-24 08:26:55,116 DEBUG fr.ans.api.sign.esignsante.psc.api.utils.HelperTest [main] decodebase64
2021-12-24 08:26:55,116 DEBUG fr.ans.api.sign.esignsante.psc.api.utils.HelperTest [main] Chaîne de caractère UTF8 &é"(,;!
2021-12-24 08:26:55,119 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
}
2021-12-24 08:26:55,120 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  200 OK
2021-12-24 08:26:55,120 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {"active":false}
2021-12-24 08:26:55,121 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  401 UNAUTHORIZED
2021-12-24 08:26:55,121 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with Mauvaise réponse..
2021-12-24 08:26:55,122 ERROR fr.ans.api.sign.esignsante.psc.utils.Helper [main] Erreur technique durant le parse de la reponse d'intropection PSC: champ Unrecognized token 'Mauvaise': was expecting (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (String)"Mauvaise réponse.."; line: 1, column: 9] 
2021-12-24 08:26:55,122 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] com.fasterxml.jackson.core.JsonParseException: Unrecognized token 'Mauvaise': was expecting (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (String)"Mauvaise réponse.."; line: 1, column: 9]
2021-12-24 08:26:55,123 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  500 INTERNAL_SERVER_ERROR
2021-12-24 08:26:55,170 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Opened connection [connectionId{localValue:22, serverValue:22}] to localhost:27017
2021-12-24 08:26:55,176 INFO fr.ans.api.sign.esignsante.psc.storage.MongoDbTest [main] *** Test d'écriture ProofStorage dans MongoDB
2021-12-24 08:26:55,177 INFO fr.ans.api.sign.esignsante.psc.storage.MongoDbTest [main] nom de base utilisée => esignsante-psc
2021-12-24 08:26:55,269 INFO fr.ans.api.sign.esignsante.psc.storage.MongoDbTest [main] Recherche de la preuve stokée id_bdd: 61c5763f405b2c3500e33b8d
2021-12-24 08:26:55,274 INFO fr.ans.api.sign.esignsante.psc.storage.MongoDbTest [main] Test stokage recherche en BDD OK
2021-12-24 08:26:55,318 INFO org.springframework.boot.StartupInfoLogger [main] Starting EsignsantePscApplicationTest using Java 11.0.2 on NXQLX078 with PID 2604 (started by cjuillard in C:\Users\cjuillard\test\esignsantepsc)
2021-12-24 08:26:55,318 DEBUG org.springframework.boot.StartupInfoLogger [main] Running with Spring Boot v2.5.2, Spring v5.3.8
2021-12-24 08:26:55,319 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-12-24 08:26:55,902 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 08:26:55,903 INFO fr.ans.api.sign.esignsante.psc.config.MongoDBConfig [main] création d'une connexion à MongoDB avec   mongodb://localhost:27017 mongoDatabase: esignsante-psc
2021-12-24 08:26:55,905 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c5763f405b2c3500e33b8e', description='null'}-localhost:27017] Opened connection [connectionId{localValue:23, serverValue:24}] to localhost:27017
2021-12-24 08:26:55,905 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c5763f405b2c3500e33b8e', description='null'}-localhost:27017] Opened connection [connectionId{localValue:24, serverValue:23}] to localhost:27017
2021-12-24 08:26:55,906 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c5763f405b2c3500e33b8e', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=1013900}
2021-12-24 08:26:56,657 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 08:26:56,660 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c57640405b2c3500e33b8f', description='null'}-localhost:27017] Opened connection [connectionId{localValue:26, serverValue:26}] to localhost:27017
2021-12-24 08:26:56,661 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57640405b2c3500e33b8f', description='null'}-localhost:27017] Opened connection [connectionId{localValue:25, serverValue:25}] to localhost:27017
2021-12-24 08:26:56,662 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57640405b2c3500e33b8f', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=1043700}
2021-12-24 08:26:56,831 INFO org.springframework.boot.StartupInfoLogger [main] Started EsignsantePscApplicationTest in 1.534 seconds (JVM running for 30.246)
2021-12-24 08:52:41,187 INFO org.springframework.test.context.support.AbstractTestContextBootstrapper [main] Neither @ContextConfiguration nor @ContextHierarchy found for test class [fr.ans.api.sign.esignsante.psc.api.DelegateMethodeInternalTest], using SpringBootContextLoader
2021-12-24 08:52:41,198 INFO org.springframework.test.context.support.AbstractContextLoader [main] Could not detect default resource locations for test class [fr.ans.api.sign.esignsante.psc.api.DelegateMethodeInternalTest]: no resource found for suffixes {-context.xml, Context.groovy}.
2021-12-24 08:52:41,200 INFO org.springframework.test.context.support.AnnotationConfigContextLoaderUtils [main] Could not detect default configuration classes for test class [fr.ans.api.sign.esignsante.psc.api.DelegateMethodeInternalTest]: DelegateMethodeInternalTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2021-12-24 08:52:41,398 INFO org.springframework.boot.test.context.SpringBootTestContextBootstrapper [main] Found @SpringBootConfiguration fr.ans.api.sign.esignsante.psc.OpenAPI2SpringBoot for test class fr.ans.api.sign.esignsante.psc.api.DelegateMethodeInternalTest
2021-12-24 08:52:41,550 INFO org.springframework.test.context.support.AbstractTestContextBootstrapper [main] Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.boot.test.mock.mockito.MockitoTestExecutionListener, org.springframework.boot.test.mock.mockito.ResetMocksTestExecutionListener, org.springframework.boot.test.autoconfigure.restdocs.RestDocsTestExecutionListener, org.springframework.boot.test.autoconfigure.web.client.MockRestServiceServerResetTestExecutionListener, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcPrintOnlyOnFailureTestExecutionListener, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverTestExecutionListener, org.springframework.boot.test.autoconfigure.webservices.client.MockWebServiceServerTestExecutionListener, org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.event.ApplicationEventsTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener, org.springframework.test.context.event.EventPublishingTestExecutionListener]
2021-12-24 08:52:41,578 INFO org.springframework.test.context.support.AbstractTestContextBootstrapper [main] Using TestExecutionListeners: [org.springframework.test.context.web.ServletTestExecutionListener@62f87c44, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@48f5bde6, org.springframework.test.context.event.ApplicationEventsTestExecutionListener@525d79f0, org.springframework.boot.test.mock.mockito.MockitoTestExecutionListener@5149f008, org.springframework.boot.test.autoconfigure.SpringBootDependencyInjectionTestExecutionListener@7072bc39, org.springframework.test.context.support.DirtiesContextTestExecutionListener@158d255c, org.springframework.test.context.transaction.TransactionalTestExecutionListener@2ca65ce4, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@327120c8, org.springframework.test.context.event.EventPublishingTestExecutionListener@5707c1cb, org.springframework.boot.test.mock.mockito.ResetMocksTestExecutionListener@2b5cb9b2, org.springframework.boot.test.autoconfigure.restdocs.RestDocsTestExecutionListener@35038141, org.springframework.boot.test.autoconfigure.web.client.MockRestServiceServerResetTestExecutionListener@ecf9049, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcPrintOnlyOnFailureTestExecutionListener@672f11c2, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverTestExecutionListener@2970a5bc, org.springframework.boot.test.autoconfigure.webservices.client.MockWebServiceServerTestExecutionListener@50305a]
2021-12-24 08:52:42,570 INFO org.springframework.boot.StartupInfoLogger [main] Starting DelegateMethodeInternalTest using Java 11.0.2 on NXQLX078 with PID 9944 (started by cjuillard in C:\Users\cjuillard\test\esignsantepsc)
2021-12-24 08:52:42,571 DEBUG org.springframework.boot.StartupInfoLogger [main] Running with Spring Boot v2.5.2, Spring v5.3.8
2021-12-24 08:52:42,575 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-12-24 08:52:45,623 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 08:52:45,690 INFO fr.ans.api.sign.esignsante.psc.config.MongoDBConfig [main] création d'une connexion à MongoDB avec   mongodb://localhost:27017 mongoDatabase: esignsante-psc
2021-12-24 08:52:45,720 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57c4d26ae266663b051ee', description='null'}-localhost:27017] Opened connection [connectionId{localValue:2, serverValue:2}] to localhost:27017
2021-12-24 08:52:45,720 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c57c4d26ae266663b051ee', description='null'}-localhost:27017] Opened connection [connectionId{localValue:1, serverValue:1}] to localhost:27017
2021-12-24 08:52:45,724 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57c4d26ae266663b051ee', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=27468600}
2021-12-24 08:52:48,723 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 08:52:48,729 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57c5026ae266663b051ef', description='null'}-localhost:27017] Opened connection [connectionId{localValue:3, serverValue:4}] to localhost:27017
2021-12-24 08:52:48,729 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c57c5026ae266663b051ef', description='null'}-localhost:27017] Opened connection [connectionId{localValue:4, serverValue:3}] to localhost:27017
2021-12-24 08:52:48,730 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57c5026ae266663b051ef', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=1736200}
2021-12-24 08:52:49,426 INFO org.springframework.boot.StartupInfoLogger [main] Started DelegateMethodeInternalTest in 7.214 seconds (JVM running for 9.378)
2021-12-24 08:52:49,566 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Requête en echec. Message retourné à l'utilisateur: Erreur dans la lecture du fichier reçu
2021-12-24 08:52:49,569 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] classe Exception: java.io.IOException
2021-12-24 08:52:49,570 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] cause de l'eException: {}
2021-12-24 08:52:49,571 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] message de l'exception null
2021-12-24 08:52:49,627 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Requête en echec. Message retourné à l'utilisateur: Erreur dans la lecture du fichier reçu
2021-12-24 08:52:49,628 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] classe Exception: java.io.IOException
2021-12-24 08:52:49,629 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] cause de l'eException: {}
2021-12-24 08:52:49,630 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] message de l'exception null
2021-12-24 08:52:49,697 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] signer: Délégataire de signature pour FamilyName (SubjectNameId)
2021-12-24 08:52:49,698 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] signer: Signé pour le compte de FamilyName (SubjectNameId)
2021-12-24 08:52:49,925 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Verification du fichier ipsfra.xml type detecté: application/xml
2021-12-24 08:52:49,926 DEBUG fr.ans.api.sign.esignsante.psc.api.DelegateMethodeTest [main] application/xml
2021-12-24 08:52:49,934 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Verification du fichier ANS.pdf type detecté: application/pdf
2021-12-24 08:52:49,938 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Verification du fichier empty.zzz type detecté: application/octet-stream
2021-12-24 08:52:49,942 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] java.io.FileNotFoundException: zzz (Le fichier spécifié est introuvable)
2021-12-24 08:52:49,942 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Requête en echec. Message retourné à l'utilisateur: Execption sur vérification du type de fichier transmis
2021-12-24 08:52:49,943 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] classe Exception: java.io.FileNotFoundException
2021-12-24 08:52:49,944 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] cause de l'eException: {}
2021-12-24 08:52:49,944 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] message de l'exception zzz (Le fichier spécifié est introuvable)
2021-12-24 08:52:49,959 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: ipsfra.xml. Use ipsfra.xml as name
2021-12-24 08:52:49,960 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile ipsfra.xml17575504030605816686.tmp
2021-12-24 08:52:49,963 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: ipsfra.xml17575504030605816686.tmp 	 length 2628
2021-12-24 08:52:49,977 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] retour appel esignsante OK pour un contrôle de signature - formatage de la réponse
2021-12-24 08:52:49,977 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] report false
2021-12-24 08:52:50,062 INFO org.springframework.boot.StartupInfoLogger [main] Starting AskApiIntegrationEsignWSOFFTest using Java 11.0.2 on NXQLX078 with PID 9944 (started by cjuillard in C:\Users\cjuillard\test\esignsantepsc)
2021-12-24 08:52:50,063 DEBUG org.springframework.boot.StartupInfoLogger [main] Running with Spring Boot v2.5.2, Spring v5.3.8
2021-12-24 08:52:50,065 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-12-24 08:52:50,856 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 08:52:50,859 INFO fr.ans.api.sign.esignsante.psc.config.MongoDBConfig [main] création d'une connexion à MongoDB avec   mongodb://localhost:27017 mongoDatabase: esignsante-psc
2021-12-24 08:52:50,866 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57c5226ae266663b051f0', description='null'}-localhost:27017] Opened connection [connectionId{localValue:5, serverValue:5}] to localhost:27017
2021-12-24 08:52:50,867 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57c5226ae266663b051f0', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=5099100}
2021-12-24 08:52:50,877 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c57c5226ae266663b051f0', description='null'}-localhost:27017] Opened connection [connectionId{localValue:6, serverValue:6}] to localhost:27017
2021-12-24 08:52:51,986 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 08:52:51,991 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c57c5326ae266663b051f1', description='null'}-localhost:27017] Opened connection [connectionId{localValue:8, serverValue:7}] to localhost:27017
2021-12-24 08:52:51,991 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57c5326ae266663b051f1', description='null'}-localhost:27017] Opened connection [connectionId{localValue:7, serverValue:8}] to localhost:27017
2021-12-24 08:52:51,992 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57c5326ae266663b051f1', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=2247900}
2021-12-24 08:52:52,307 INFO org.springframework.boot.StartupInfoLogger [main] Started AskApiIntegrationEsignWSOFFTest in 2.282 seconds (JVM running for 12.259)
2021-12-24 08:52:52,437 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Réception d'une demande de signature Xades
2021-12-24 08:52:52,440 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
}
2021-12-24 08:52:52,454 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  200 OK
2021-12-24 08:52:52,455 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel PSC intropesction: token= accessTokenValue  reponse PSC = {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-24 08:52:52,456 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: ipsfra.xml. Use ipsfra.xml as name
2021-12-24 08:52:52,457 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile ipsfra.xml13634915256287110875.tmp
2021-12-24 08:52:52,458 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: ipsfra.xml13634915256287110875.tmp 	 length 2628
2021-12-24 08:52:52,542 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Verification du fichier ipsfra.xml13634915256287110875.tmp type detecté: text/plain
2021-12-24 08:52:52,543 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Demande de signature valide: verif AccessToken OK: {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
, File OK ipsfra.xml13634915256287110875.tmp 
, userInfo OK Organisation: CABINET M SPECIALISTE0021889
2021-12-24 08:52:52,544 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] openidtoken[0] transmis à esignWS:
2021-12-24 08:52:52,545 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 userinfo (base64): eyJTZWN0ZXVyX0FjdGl2aXRlIjoiU0EwN14xLjIuMjUwLjEuNzEuNC4yLjQiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIlN1YmplY3RPcmdhbml6YXRpb24iOiJDQUJJTkVUIE0gU1BFQ0lBTElTVEUwMDIxODg5IiwicHJlZmVycmVkX3VzZXJuYW1lIjoiODk5NzAwMjE4ODk2IiwiZ2l2ZW5fbmFtZSI6IlJPQkVSVCIsIlN1YmplY3RSZWZQcm8iOnsiY29kZUNpdmlsaXRlIjoiTSIsImV4ZXJjaWNlcyI6W3siY29kZVByb2Zlc3Npb24iOiIxMCIsIm5vbURleGVyY2ljZSI6IlNQRUNJQUxJU1RFMDAyMTg4OSIsInByZW5vbURleGVyY2ljZSI6IlJPQkVSVCIsImNvZGVUeXBlU2F2b2lyRmFpcmUiOiIifV19LCJTdWJqZWN0Um9sZSI6WyIxMF4xLjIuMjUwLjEuMjEzLjEuMS41LjUiXSwiU3ViamVjdE5hbWVJRCI6Ijg5OTcwMDIxODg5NiIsImZhbWlseV9uYW1lIjoiU1BFQ0lBTElTVEUwMDIxODg5In0= 
2021-12-24 08:52:52,546 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 accessToken: accessTokenValue 
2021-12-24 08:52:52,549 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 PSCResponse: {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-24 08:52:52,550 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] signer: Délégataire de signature pour SPECIALISTE0021889 (899700218896)
2021-12-24 08:52:52,551 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel esignWS pour une signature de type XADES
2021-12-24 08:52:52,574 INFO fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] Appel esignante Webservices pour basePath = http://localhost:8081/esignsante/v1
2021-12-24 08:52:52,574 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] appel esignsanteWebservices pour une demande de signature en xades 
2021-12-24 08:52:52,575 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] fileToSign: ipsfra.xml13634915256287110875.tmp
2021-12-24 08:52:52,577 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] paramètres: basePath: http://localhost:8081/esignsante/v1 
 idSignConf: 1 
 proofConfId: 1 

2021-12-24 08:52:54,716 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Requête en echec. Message retourné à l'utilisateur: Exception sur appel esignWS. Service inaccessible
2021-12-24 08:52:54,718 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] classe Exception: org.springframework.web.client.ResourceAccessException
2021-12-24 08:52:54,726 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] cause de l'eException: {}
java.net.ConnectException: Connection refused: connect
	at java.base/java.net.PlainSocketImpl.connect0(Native Method)
	at java.base/java.net.PlainSocketImpl.socketConnect(PlainSocketImpl.java:101)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:399)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:242)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:224)
	at java.base/java.net.Socket.connect(Socket.java:591)
	at java.base/java.net.Socket.connect(Socket.java:540)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:182)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:474)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:569)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:242)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:341)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:362)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1242)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1181)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1075)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1009)
	at org.springframework.http.client.SimpleBufferingClientHttpRequest.executeInternal(SimpleBufferingClientHttpRequest.java:76)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.http.client.BufferingClientHttpRequestWrapper.executeInternal(BufferingClientHttpRequestWrapper.java:63)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:776)
	at org.springframework.web.client.RestTemplate.exchange(RestTemplate.java:670)
	at fr.ans.esignsante.ApiClient.invokeAPI(ApiClient.java:526)
	at fr.ans.esignsante.api.XadesApi.signatureXadesWithProof(XadesApi.java:207)
	at fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall.signatureXades(EsignsanteCall.java:56)
	at fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl.executeAskSignature(AsksignatureApiDelegateImpl.java:288)
	at fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl.postAsksignatureXades(AsksignatureApiDelegateImpl.java:129)
	at fr.ans.api.sign.esignsante.psc.api.AsksignatureApi.postAsksignatureXades(AsksignatureApi.java:91)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:894)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1063)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:681)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at org.springframework.test.web.servlet.TestDispatcherServlet.service(TestDispatcherServlet.java:72)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
	at org.springframework.mock.web.MockFilterChain$ServletFilterProxy.doFilter(MockFilterChain.java:167)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:134)
	at org.springframework.test.web.servlet.MockMvc.perform(MockMvc.java:183)
	at fr.ans.api.sign.esignsante.psc.api.requests.AskApiIntegrationEsignWSOFFTest.askSignXADES_esignWS_OFFTest(AskApiIntegrationEsignWSOFFTest.java:93)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:688)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:140)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:84)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$6(TestMethodTestDescriptor.java:210)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:206)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:131)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:65)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1540)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1540)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:32)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:51)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:220)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$6(DefaultLauncher.java:188)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:202)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:181)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:128)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:150)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2021-12-24 08:52:54,732 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] message de l'exception I/O error on POST request for "http://localhost:8081/esignsante/v1/signatures/xadesbaselinebwithproof": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect
2021-12-24 08:52:54,836 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Réception d'une demande de signature Pades
2021-12-24 08:52:54,837 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
}
2021-12-24 08:52:54,838 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  200 OK
2021-12-24 08:52:54,839 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel PSC intropesction: token= accessTokenValue  reponse PSC = {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-24 08:52:54,840 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: ANS.pdf. Use ANS.pdf as name
2021-12-24 08:52:54,841 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile ANS.pdf4321593220009596669.tmp
2021-12-24 08:52:54,843 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: ANS.pdf4321593220009596669.tmp 	 length 97996
2021-12-24 08:52:54,876 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Verification du fichier ANS.pdf4321593220009596669.tmp type detecté: application/pdf
2021-12-24 08:52:54,877 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Demande de signature valide: verif AccessToken OK: {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
, File OK ANS.pdf4321593220009596669.tmp 
, userInfo OK Organisation: CABINET M SPECIALISTE0021889
2021-12-24 08:52:54,878 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] openidtoken[0] transmis à esignWS:
2021-12-24 08:52:54,878 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 userinfo (base64): eyJTZWN0ZXVyX0FjdGl2aXRlIjoiU0EwN14xLjIuMjUwLjEuNzEuNC4yLjQiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIlN1YmplY3RPcmdhbml6YXRpb24iOiJDQUJJTkVUIE0gU1BFQ0lBTElTVEUwMDIxODg5IiwicHJlZmVycmVkX3VzZXJuYW1lIjoiODk5NzAwMjE4ODk2IiwiZ2l2ZW5fbmFtZSI6IlJPQkVSVCIsIlN1YmplY3RSZWZQcm8iOnsiY29kZUNpdmlsaXRlIjoiTSIsImV4ZXJjaWNlcyI6W3siY29kZVByb2Zlc3Npb24iOiIxMCIsIm5vbURleGVyY2ljZSI6IlNQRUNJQUxJU1RFMDAyMTg4OSIsInByZW5vbURleGVyY2ljZSI6IlJPQkVSVCIsImNvZGVUeXBlU2F2b2lyRmFpcmUiOiIifV19LCJTdWJqZWN0Um9sZSI6WyIxMF4xLjIuMjUwLjEuMjEzLjEuMS41LjUiXSwiU3ViamVjdE5hbWVJRCI6Ijg5OTcwMDIxODg5NiIsImZhbWlseV9uYW1lIjoiU1BFQ0lBTElTVEUwMDIxODg5In0= 
2021-12-24 08:52:54,879 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 accessToken: accessTokenValue 
2021-12-24 08:52:54,880 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 PSCResponse: {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-24 08:52:54,880 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] signer: Signé pour le compte de SPECIALISTE0021889 (899700218896)
2021-12-24 08:52:54,881 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel esignWS pour une signature de type PADES
2021-12-24 08:52:54,891 INFO fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] Appel esignante Webservices pour basePath = http://localhost:8081/esignsante/v1
2021-12-24 08:52:54,892 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] appel esignsanteWebservices pour une demande de signature en PADES 
2021-12-24 08:52:54,893 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] fileToSign: ANS.pdf4321593220009596669.tmp
2021-12-24 08:52:54,897 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] paramètres: basePath: http://localhost:8081/esignsante/v1 
 idSignConf: 1 
 proofConfId: 1 

2021-12-24 08:52:56,954 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Requête en echec. Message retourné à l'utilisateur: Exception sur appel esignWS. Service inaccessible
2021-12-24 08:52:56,956 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] classe Exception: org.springframework.web.client.ResourceAccessException
2021-12-24 08:52:56,958 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] cause de l'eException: {}
java.net.ConnectException: Connection refused: connect
	at java.base/java.net.PlainSocketImpl.connect0(Native Method)
	at java.base/java.net.PlainSocketImpl.socketConnect(PlainSocketImpl.java:101)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:399)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:242)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:224)
	at java.base/java.net.Socket.connect(Socket.java:591)
	at java.base/java.net.Socket.connect(Socket.java:540)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:182)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:474)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:569)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:242)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:341)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:362)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1242)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1181)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1075)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1009)
	at org.springframework.http.client.SimpleBufferingClientHttpRequest.executeInternal(SimpleBufferingClientHttpRequest.java:76)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.http.client.BufferingClientHttpRequestWrapper.executeInternal(BufferingClientHttpRequestWrapper.java:63)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:776)
	at org.springframework.web.client.RestTemplate.exchange(RestTemplate.java:670)
	at fr.ans.esignsante.ApiClient.invokeAPI(ApiClient.java:526)
	at fr.ans.esignsante.api.PadesApi.signaturePadesWithProof(PadesApi.java:207)
	at fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall.signaturePades(EsignsanteCall.java:77)
	at fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl.executeAskSignature(AsksignatureApiDelegateImpl.java:286)
	at fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl.postAskSignaturePades(AsksignatureApiDelegateImpl.java:92)
	at fr.ans.api.sign.esignsante.psc.api.AsksignatureApi.postAskSignaturePades(AsksignatureApi.java:58)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:894)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1063)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:681)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at org.springframework.test.web.servlet.TestDispatcherServlet.service(TestDispatcherServlet.java:72)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
	at org.springframework.mock.web.MockFilterChain$ServletFilterProxy.doFilter(MockFilterChain.java:167)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:134)
	at org.springframework.test.web.servlet.MockMvc.perform(MockMvc.java:183)
	at fr.ans.api.sign.esignsante.psc.api.requests.AskApiIntegrationEsignWSOFFTest.askSignPADES_esignWS_OFFTest(AskApiIntegrationEsignWSOFFTest.java:130)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:688)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:140)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:84)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$6(TestMethodTestDescriptor.java:210)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:206)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:131)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:65)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1540)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1540)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:32)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:51)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:220)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$6(DefaultLauncher.java:188)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:202)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:181)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:128)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:150)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2021-12-24 08:52:56,962 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] message de l'exception I/O error on POST request for "http://localhost:8081/esignsante/v1/signatures/padesbaselinebwithproof": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect
2021-12-24 08:52:57,074 INFO org.springframework.boot.StartupInfoLogger [main] Starting AskApiIntegrationTest using Java 11.0.2 on NXQLX078 with PID 9944 (started by cjuillard in C:\Users\cjuillard\test\esignsantepsc)
2021-12-24 08:52:57,075 DEBUG org.springframework.boot.StartupInfoLogger [main] Running with Spring Boot v2.5.2, Spring v5.3.8
2021-12-24 08:52:57,076 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-12-24 08:52:57,692 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 08:52:57,693 INFO fr.ans.api.sign.esignsante.psc.config.MongoDBConfig [main] création d'une connexion à MongoDB avec   mongodb://localhost:27017 mongoDatabase: esignsante-psc
2021-12-24 08:52:57,697 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57c5926ae266663b051f2', description='null'}-localhost:27017] Opened connection [connectionId{localValue:9, serverValue:9}] to localhost:27017
2021-12-24 08:52:57,697 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c57c5926ae266663b051f2', description='null'}-localhost:27017] Opened connection [connectionId{localValue:10, serverValue:10}] to localhost:27017
2021-12-24 08:52:57,697 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57c5926ae266663b051f2', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=2013900}
2021-12-24 08:52:58,749 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 08:52:58,755 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57c5a26ae266663b051f3', description='null'}-localhost:27017] Opened connection [connectionId{localValue:11, serverValue:11}] to localhost:27017
2021-12-24 08:52:58,755 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57c5a26ae266663b051f3', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=1409400}
2021-12-24 08:52:58,757 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c57c5a26ae266663b051f3', description='null'}-localhost:27017] Opened connection [connectionId{localValue:12, serverValue:12}] to localhost:27017
2021-12-24 08:52:59,060 INFO org.springframework.boot.StartupInfoLogger [main] Started AskApiIntegrationTest in 2.023 seconds (JVM running for 19.013)
2021-12-24 08:52:59,078 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Réception d'une demande de signature Pades
2021-12-24 08:52:59,080 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
}
2021-12-24 08:52:59,082 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  200 OK
2021-12-24 08:52:59,082 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel PSC intropesction: token= accessTokenValue  reponse PSC = {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-24 08:52:59,084 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: ipsfra.xml. Use ipsfra.xml as name
2021-12-24 08:52:59,084 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile ipsfra.xml18221148808686134330.tmp
2021-12-24 08:52:59,086 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: ipsfra.xml18221148808686134330.tmp 	 length 2628
2021-12-24 08:52:59,096 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Verification du fichier ipsfra.xml18221148808686134330.tmp type detecté: text/plain
2021-12-24 08:52:59,140 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Réception d'une demande de signature Xades
2021-12-24 08:52:59,141 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
}
2021-12-24 08:52:59,142 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  200 OK
2021-12-24 08:52:59,143 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel PSC intropesction: token= accessTokenValue  reponse PSC = {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-24 08:52:59,144 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: ipsfra.xml. Use ipsfra.xml as name
2021-12-24 08:52:59,145 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile ipsfra.xml17516047427457484619.tmp
2021-12-24 08:52:59,146 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: ipsfra.xml17516047427457484619.tmp 	 length 2628
2021-12-24 08:52:59,160 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Verification du fichier ipsfra.xml17516047427457484619.tmp type detecté: text/plain
2021-12-24 08:52:59,160 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Demande de signature valide: verif AccessToken OK: {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
, File OK ipsfra.xml17516047427457484619.tmp 
, userInfo OK Organisation: CABINET M SPECIALISTE0021889
2021-12-24 08:52:59,161 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] openidtoken[0] transmis à esignWS:
2021-12-24 08:52:59,161 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 userinfo (base64): eyJTZWN0ZXVyX0FjdGl2aXRlIjoiU0EwN14xLjIuMjUwLjEuNzEuNC4yLjQiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIlN1YmplY3RPcmdhbml6YXRpb24iOiJDQUJJTkVUIE0gU1BFQ0lBTElTVEUwMDIxODg5IiwicHJlZmVycmVkX3VzZXJuYW1lIjoiODk5NzAwMjE4ODk2IiwiZ2l2ZW5fbmFtZSI6IlJPQkVSVCIsIlN1YmplY3RSZWZQcm8iOnsiY29kZUNpdmlsaXRlIjoiTSIsImV4ZXJjaWNlcyI6W3siY29kZVByb2Zlc3Npb24iOiIxMCIsIm5vbURleGVyY2ljZSI6IlNQRUNJQUxJU1RFMDAyMTg4OSIsInByZW5vbURleGVyY2ljZSI6IlJPQkVSVCIsImNvZGVUeXBlU2F2b2lyRmFpcmUiOiIifV19LCJTdWJqZWN0Um9sZSI6WyIxMF4xLjIuMjUwLjEuMjEzLjEuMS41LjUiXSwiU3ViamVjdE5hbWVJRCI6Ijg5OTcwMDIxODg5NiIsImZhbWlseV9uYW1lIjoiU1BFQ0lBTElTVEUwMDIxODg5In0= 
2021-12-24 08:52:59,162 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 accessToken: accessTokenValue 
2021-12-24 08:52:59,163 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 PSCResponse: {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-24 08:52:59,163 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] signer: Délégataire de signature pour SPECIALISTE0021889 (899700218896)
2021-12-24 08:52:59,164 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel esignWS pour une signature de type XADES
2021-12-24 08:52:59,165 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main]  START archivage de la preuve en BDD pour request id: 6de041d2-6221-48a3-957d-f1cf5da5be6d
2021-12-24 08:52:59,166 DEBUG fr.ans.api.sign.esignsante.psc.storage.repository.PreuveDAOImpl [main] demande persistence de la preuve d'une demande de signature pour: 
  SubjectOrganization: CABINET M SPECIALISTE0021889 
  Preferred_username: 899700218896 
 Given_name: ROBERT 
Family_name:SPECIALISTE0021889  
 Timestamp (acceptation de la reqête): Fri Dec 24 08:52:59 CET 2021   
2021-12-24 08:52:59,236 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Opened connection [connectionId{localValue:13, serverValue:13}] to localhost:27017
2021-12-24 08:52:59,286 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Fin archivage de la preuve en BDD pour request id: 6de041d2-6221-48a3-957d-f1cf5da5be6d
2021-12-24 08:52:59,346 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Réception d'une demande de signature Pades
2021-12-24 08:52:59,348 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {
    "active": false
}
2021-12-24 08:52:59,348 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  401 UNAUTHORIZED
2021-12-24 08:52:59,349 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel PSC intropesction: token= accessTokenValue  reponse PSC = {
    "active": false
} 
2021-12-24 08:52:59,387 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Réception d'une demande de signature Xades
2021-12-24 08:52:59,389 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {
    "active": false
}
2021-12-24 08:52:59,390 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  401 UNAUTHORIZED
2021-12-24 08:52:59,391 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel PSC intropesction: token= accessTokenValue  reponse PSC = {
    "active": false
} 
2021-12-24 08:52:59,418 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Réception d'une demande de signature Pades
2021-12-24 08:52:59,420 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
}
2021-12-24 08:52:59,421 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  200 OK
2021-12-24 08:52:59,422 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel PSC intropesction: token= accessTokenValue  reponse PSC = {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-24 08:52:59,423 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: ANS.pdf. Use ANS.pdf as name
2021-12-24 08:52:59,424 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile ANS.pdf17800417657206791548.tmp
2021-12-24 08:52:59,427 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: ANS.pdf17800417657206791548.tmp 	 length 97996
2021-12-24 08:52:59,475 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Verification du fichier ANS.pdf17800417657206791548.tmp type detecté: application/pdf
2021-12-24 08:52:59,476 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Demande de signature valide: verif AccessToken OK: {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
, File OK ANS.pdf17800417657206791548.tmp 
, userInfo OK Organisation: CABINET M SPECIALISTE0021889
2021-12-24 08:52:59,476 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] openidtoken[0] transmis à esignWS:
2021-12-24 08:52:59,477 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 userinfo (base64): eyJTZWN0ZXVyX0FjdGl2aXRlIjoiU0EwN14xLjIuMjUwLjEuNzEuNC4yLjQiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIlN1YmplY3RPcmdhbml6YXRpb24iOiJDQUJJTkVUIE0gU1BFQ0lBTElTVEUwMDIxODg5IiwicHJlZmVycmVkX3VzZXJuYW1lIjoiODk5NzAwMjE4ODk2IiwiZ2l2ZW5fbmFtZSI6IlJPQkVSVCIsIlN1YmplY3RSZWZQcm8iOnsiY29kZUNpdmlsaXRlIjoiTSIsImV4ZXJjaWNlcyI6W3siY29kZVByb2Zlc3Npb24iOiIxMCIsIm5vbURleGVyY2ljZSI6IlNQRUNJQUxJU1RFMDAyMTg4OSIsInByZW5vbURleGVyY2ljZSI6IlJPQkVSVCIsImNvZGVUeXBlU2F2b2lyRmFpcmUiOiIifV19LCJTdWJqZWN0Um9sZSI6WyIxMF4xLjIuMjUwLjEuMjEzLjEuMS41LjUiXSwiU3ViamVjdE5hbWVJRCI6Ijg5OTcwMDIxODg5NiIsImZhbWlseV9uYW1lIjoiU1BFQ0lBTElTVEUwMDIxODg5In0= 
2021-12-24 08:52:59,477 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 accessToken: accessTokenValue 
2021-12-24 08:52:59,478 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 PSCResponse: {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-24 08:52:59,478 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] signer: Signé pour le compte de SPECIALISTE0021889 (899700218896)
2021-12-24 08:52:59,479 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel esignWS pour une signature de type PADES
2021-12-24 08:52:59,479 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main]  START archivage de la preuve en BDD pour request id: bde6ab51-fa15-4584-b287-401ee3b31349
2021-12-24 08:52:59,480 DEBUG fr.ans.api.sign.esignsante.psc.storage.repository.PreuveDAOImpl [main] demande persistence de la preuve d'une demande de signature pour: 
  SubjectOrganization: CABINET M SPECIALISTE0021889 
  Preferred_username: 899700218896 
 Given_name: ROBERT 
Family_name:SPECIALISTE0021889  
 Timestamp (acceptation de la reqête): Fri Dec 24 08:52:59 CET 2021   
2021-12-24 08:52:59,482 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Fin archivage de la preuve en BDD pour request id: bde6ab51-fa15-4584-b287-401ee3b31349
2021-12-24 08:52:59,524 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Réception d'une demande des CAs
2021-12-24 08:52:59,533 INFO fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] Appel esignante Webservices pour basePath = http://localhost:8081/esignsante/v1
2021-12-24 08:53:01,586 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Requête en echec. Message retourné à l'utilisateur: Exception sur appel esignWS. Service inaccessible
2021-12-24 08:53:01,588 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] classe Exception: org.springframework.web.client.ResourceAccessException
2021-12-24 08:53:01,590 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] cause de l'eException: {}
java.net.ConnectException: Connection refused: connect
	at java.base/java.net.PlainSocketImpl.connect0(Native Method)
	at java.base/java.net.PlainSocketImpl.socketConnect(PlainSocketImpl.java:101)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:399)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:242)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:224)
	at java.base/java.net.Socket.connect(Socket.java:591)
	at java.base/java.net.Socket.connect(Socket.java:540)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:182)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:474)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:569)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:242)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:341)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:362)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1242)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1181)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1075)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1009)
	at org.springframework.http.client.SimpleBufferingClientHttpRequest.executeInternal(SimpleBufferingClientHttpRequest.java:76)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.http.client.BufferingClientHttpRequestWrapper.executeInternal(BufferingClientHttpRequestWrapper.java:63)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:776)
	at org.springframework.web.client.RestTemplate.exchange(RestTemplate.java:670)
	at fr.ans.esignsante.ApiClient.invokeAPI(ApiClient.java:526)
	at fr.ans.esignsante.api.CaApi.getCA(CaApi.java:73)
	at fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall.getCA(EsignsanteCall.java:124)
	at fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl.getCa(CaApiDelegateImpl.java:40)
	at fr.ans.api.sign.esignsante.psc.api.CaApi.getCa(CaApi.java:46)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:894)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1063)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:655)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at org.springframework.test.web.servlet.TestDispatcherServlet.service(TestDispatcherServlet.java:72)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
	at org.springframework.mock.web.MockFilterChain$ServletFilterProxy.doFilter(MockFilterChain.java:167)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:134)
	at org.springframework.test.web.servlet.MockMvc.perform(MockMvc.java:183)
	at fr.ans.api.sign.esignsante.psc.api.requests.CAApiIntegrationEsignWSOFFTest.caGet_esignWS_OFFTest(CAApiIntegrationEsignWSOFFTest.java:52)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:688)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:140)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:84)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$6(TestMethodTestDescriptor.java:210)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:206)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:131)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:65)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1540)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1540)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:32)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:51)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:220)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$6(DefaultLauncher.java:188)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:202)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:181)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:128)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:150)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2021-12-24 08:53:01,593 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] message de l'exception I/O error on GET request for "http://localhost:8081/esignsante/v1/ca": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect
2021-12-24 08:53:01,691 INFO org.springframework.boot.StartupInfoLogger [main] Starting CAApiIntegrationTest using Java 11.0.2 on NXQLX078 with PID 9944 (started by cjuillard in C:\Users\cjuillard\test\esignsantepsc)
2021-12-24 08:53:01,692 DEBUG org.springframework.boot.StartupInfoLogger [main] Running with Spring Boot v2.5.2, Spring v5.3.8
2021-12-24 08:53:01,693 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-12-24 08:53:02,235 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 08:53:02,236 INFO fr.ans.api.sign.esignsante.psc.config.MongoDBConfig [main] création d'une connexion à MongoDB avec   mongodb://localhost:27017 mongoDatabase: esignsante-psc
2021-12-24 08:53:02,238 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57c5e26ae266663b051f6', description='null'}-localhost:27017] Opened connection [connectionId{localValue:14, serverValue:14}] to localhost:27017
2021-12-24 08:53:02,239 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57c5e26ae266663b051f6', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=777700}
2021-12-24 08:53:02,239 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c57c5e26ae266663b051f6', description='null'}-localhost:27017] Opened connection [connectionId{localValue:15, serverValue:15}] to localhost:27017
2021-12-24 08:53:03,212 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 08:53:03,217 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57c5f26ae266663b051f7', description='null'}-localhost:27017] Opened connection [connectionId{localValue:16, serverValue:16}] to localhost:27017
2021-12-24 08:53:03,217 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57c5f26ae266663b051f7', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=1395300}
2021-12-24 08:53:03,219 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c57c5f26ae266663b051f7', description='null'}-localhost:27017] Opened connection [connectionId{localValue:17, serverValue:17}] to localhost:27017
2021-12-24 08:53:03,468 INFO org.springframework.boot.StartupInfoLogger [main] Started CAApiIntegrationTest in 1.82 seconds (JVM running for 23.421)
2021-12-24 08:53:03,501 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Réception d'une demande des CAs
2021-12-24 08:53:03,503 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Demande des CAs traitée avec succès
2021-12-24 08:53:03,525 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Réception d'une demande des CAs
2021-12-24 08:53:03,526 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Demande des CAs traitée avec succès
2021-12-24 08:53:03,529 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Réception d'une demande des CAs
2021-12-24 08:53:03,529 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Demande des CAs traitée avec succès
2021-12-24 08:53:03,532 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Réception d'une demande des CAs
2021-12-24 08:53:03,533 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Demande des CAs traitée avec succès
2021-12-24 08:53:03,541 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Réception d'une demande des CAs
2021-12-24 08:53:03,542 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Demande des CAs traitée avec succès
2021-12-24 08:53:03,562 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Réception d'une demande des CAs
2021-12-24 08:53:03,563 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Demande des CAs traitée avec succès
2021-12-24 08:53:03,601 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Demande Checksignature Pades reçue
2021-12-24 08:53:03,603 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: signedipsfra.xml. Use signedipsfra.xml as name
2021-12-24 08:53:03,604 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile signedipsfra.xml17356823802731267718.tmp
2021-12-24 08:53:03,605 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: signedipsfra.xml17356823802731267718.tmp 	 length 10239
2021-12-24 08:53:03,607 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] message 501 501 

2021-12-24 08:53:03,607 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] toString org.springframework.web.client.HttpServerErrorException$NotImplemented: 501 501 

2021-12-24 08:53:03,608 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] class Name org.springframework.web.client.HttpServerErrorException$NotImplemented 

2021-12-24 08:53:03,608 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] class Canonicalname org.springframework.web.client.HttpServerErrorException.NotImplemented 

2021-12-24 08:53:03,609 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Echec de l'appel à esignsanteWS => HttpServerErrorException.NotImplemented
2021-12-24 08:53:03,638 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Réception d'une demande Checksignature Pades.
2021-12-24 08:53:03,640 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: ANS_SIGNED.pdf. Use ANS_SIGNED.pdf as name
2021-12-24 08:53:03,641 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile ANS_SIGNED.pdf15665666537982436253.tmp
2021-12-24 08:53:03,643 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: ANS_SIGNED.pdf15665666537982436253.tmp 	 length 118076
2021-12-24 08:53:03,645 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] message 501 501 

2021-12-24 08:53:03,646 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] toString org.springframework.web.client.HttpServerErrorException$NotImplemented: 501 501 

2021-12-24 08:53:03,646 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] class Name org.springframework.web.client.HttpServerErrorException$NotImplemented 

2021-12-24 08:53:03,647 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] class Canonicalname org.springframework.web.client.HttpServerErrorException.NotImplemented 

2021-12-24 08:53:03,648 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Echec de l'appel à esignsanteWS => HttpServerErrorException.NotImplemented
2021-12-24 08:53:03,712 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Réception d'une demande Checksignature Pades.
2021-12-24 08:53:03,713 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: . Use  as name
2021-12-24 08:53:03,714 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile 7163992049903214887.tmp
2021-12-24 08:53:03,716 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: 7163992049903214887.tmp 	 length 32158
2021-12-24 08:53:03,725 INFO fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] Appel esignante Webservices pour basePath = http://localhost:8081/esignsante/v1
2021-12-24 08:53:03,725 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] appel esignsanteWebservices pour une VERIF de signature en xades
2021-12-24 08:53:03,739 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] paramètres: basePath: http://localhost:8081/esignsante/v1 id checkSign d esignsante: 1 file: 7163992049903214887.tmp
2021-12-24 08:53:03,740 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] fileExist:true
2021-12-24 08:53:05,815 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] message I/O error on POST request for "http://localhost:8081/esignsante/v1/validation/signatures/xadesbaselineb": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect 

2021-12-24 08:53:05,817 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] toString org.springframework.web.client.ResourceAccessException: I/O error on POST request for "http://localhost:8081/esignsante/v1/validation/signatures/xadesbaselineb": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect 

2021-12-24 08:53:05,818 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] class Name org.springframework.web.client.ResourceAccessException 

2021-12-24 08:53:05,819 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] class Canonicalname org.springframework.web.client.ResourceAccessException 

2021-12-24 08:53:05,820 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Exception sur appel esignWS. Service inaccessible
2021-12-24 08:53:05,888 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Demande Checksignature Pades reçue
2021-12-24 08:53:05,889 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: . Use  as name
2021-12-24 08:53:05,890 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile 3270299117219580989.tmp
2021-12-24 08:53:05,891 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: 3270299117219580989.tmp 	 length 118076
2021-12-24 08:53:05,897 INFO fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] Appel esignante Webservices pour basePath = http://localhost:8081/esignsante/v1
2021-12-24 08:53:05,897 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] appel esignsanteWebservices pour une VERIF de signature en PADES
2021-12-24 08:53:05,898 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] paramètres: basePath: http://localhost:8081/esignsante/v1 id checkSign d esignsante: 1 file: 3270299117219580989.tmp
2021-12-24 08:53:05,898 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] fileExist:true
2021-12-24 08:53:07,973 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] message I/O error on POST request for "http://localhost:8081/esignsante/v1/validation/signatures/padesbaselineb": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect 

2021-12-24 08:53:07,975 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] toString org.springframework.web.client.ResourceAccessException: I/O error on POST request for "http://localhost:8081/esignsante/v1/validation/signatures/padesbaselineb": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect 

2021-12-24 08:53:07,976 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] class Name org.springframework.web.client.ResourceAccessException 

2021-12-24 08:53:07,977 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] class Canonicalname org.springframework.web.client.ResourceAccessException 

2021-12-24 08:53:07,978 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Exception sur appel esignWS. Service inaccessible
2021-12-24 08:53:08,072 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Demande Checksignature Pades reçue
2021-12-24 08:53:08,073 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: ANS_SIGNED.pdf. Use ANS_SIGNED.pdf as name
2021-12-24 08:53:08,074 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile ANS_SIGNED.pdf12449849839242674440.tmp
2021-12-24 08:53:08,076 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: ANS_SIGNED.pdf12449849839242674440.tmp 	 length 118076
2021-12-24 08:53:08,077 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] retour appel esignsante OK pour un contrôle de signature - formatage de la réponse
2021-12-24 08:53:08,078 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] report true
2021-12-24 08:53:08,120 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Réception d'une demande Checksignature Pades.
2021-12-24 08:53:08,122 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: signedipsfra.xml. Use signedipsfra.xml as name
2021-12-24 08:53:08,122 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile signedipsfra.xml10827549884190777395.tmp
2021-12-24 08:53:08,123 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: signedipsfra.xml10827549884190777395.tmp 	 length 10239
2021-12-24 08:53:08,125 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] retour appel esignsante OK pour un contrôle de signature - formatage de la réponse
2021-12-24 08:53:08,126 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] report true
2021-12-24 08:53:08,159 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.DefaultApiDelegateImpl [main] Réception d'une demande des opérations disponibles
2021-12-24 08:53:08,185 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.DefaultApiDelegateImpl [main] Réception d'une demande des opérations disponibles
2021-12-24 08:53:08,237 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.DefaultApiDelegateImpl [main] Réception d'une demande des opérations disponibles
2021-12-24 08:53:08,297 INFO org.springframework.boot.StartupInfoLogger [main] Starting HelperTest using Java 11.0.2 on NXQLX078 with PID 9944 (started by cjuillard in C:\Users\cjuillard\test\esignsantepsc)
2021-12-24 08:53:08,297 DEBUG org.springframework.boot.StartupInfoLogger [main] Running with Spring Boot v2.5.2, Spring v5.3.8
2021-12-24 08:53:08,299 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-12-24 08:53:08,886 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 08:53:08,887 INFO fr.ans.api.sign.esignsante.psc.config.MongoDBConfig [main] création d'une connexion à MongoDB avec   mongodb://localhost:27017 mongoDatabase: esignsante-psc
2021-12-24 08:53:08,890 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c57c6426ae266663b051f8', description='null'}-localhost:27017] Opened connection [connectionId{localValue:19, serverValue:19}] to localhost:27017
2021-12-24 08:53:08,890 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57c6426ae266663b051f8', description='null'}-localhost:27017] Opened connection [connectionId{localValue:18, serverValue:18}] to localhost:27017
2021-12-24 08:53:08,891 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57c6426ae266663b051f8', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=848500}
2021-12-24 08:53:09,747 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 08:53:09,751 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c57c6526ae266663b051f9', description='null'}-localhost:27017] Opened connection [connectionId{localValue:21, serverValue:20}] to localhost:27017
2021-12-24 08:53:09,751 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57c6526ae266663b051f9', description='null'}-localhost:27017] Opened connection [connectionId{localValue:20, serverValue:21}] to localhost:27017
2021-12-24 08:53:09,751 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57c6526ae266663b051f9', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=1167000}
2021-12-24 08:53:09,953 INFO org.springframework.boot.StartupInfoLogger [main] Started HelperTest in 1.689 seconds (JVM running for 29.905)
2021-12-24 08:53:09,961 DEBUG fr.ans.api.sign.esignsante.psc.api.utils.HelperTest [main] encodebase64
2021-12-24 08:53:09,962 DEBUG fr.ans.api.sign.esignsante.psc.api.utils.HelperTest [main] Q2hhw65uZSBkZSBjYXJhY3TDqHJlIFVURjggJsOpIigsOyE=
2021-12-24 08:53:09,967 DEBUG fr.ans.api.sign.esignsante.psc.api.utils.HelperTest [main] test conversion Erreur(esignsante) en Error (esigsante-psc
2021-12-24 08:53:09,969 DEBUG fr.ans.api.sign.esignsante.psc.api.utils.HelperTest [main] code :codeErreur1 msg :message1
2021-12-24 08:53:09,969 DEBUG fr.ans.api.sign.esignsante.psc.api.utils.HelperTest [main] code :codeErreur2 msg :message2
2021-12-24 08:53:09,977 DEBUG fr.ans.api.sign.esignsante.psc.api.utils.HelperTest [main] decodebase64
2021-12-24 08:53:09,977 DEBUG fr.ans.api.sign.esignsante.psc.api.utils.HelperTest [main] Chaîne de caractère UTF8 &é"(,;!
2021-12-24 08:53:09,981 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
}
2021-12-24 08:53:09,982 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  200 OK
2021-12-24 08:53:09,982 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {"active":false}
2021-12-24 08:53:09,983 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  401 UNAUTHORIZED
2021-12-24 08:53:09,983 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with Mauvaise réponse..
2021-12-24 08:53:09,984 ERROR fr.ans.api.sign.esignsante.psc.utils.Helper [main] Erreur technique durant le parse de la reponse d'intropection PSC: champ Unrecognized token 'Mauvaise': was expecting (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (String)"Mauvaise réponse.."; line: 1, column: 9] 
2021-12-24 08:53:09,984 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] com.fasterxml.jackson.core.JsonParseException: Unrecognized token 'Mauvaise': was expecting (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (String)"Mauvaise réponse.."; line: 1, column: 9]
2021-12-24 08:53:09,984 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  500 INTERNAL_SERVER_ERROR
2021-12-24 08:53:10,032 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Opened connection [connectionId{localValue:22, serverValue:22}] to localhost:27017
2021-12-24 08:53:10,040 INFO fr.ans.api.sign.esignsante.psc.storage.MongoDbTest [main] *** Test d'écriture ProofStorage dans MongoDB
2021-12-24 08:53:10,041 INFO fr.ans.api.sign.esignsante.psc.storage.MongoDbTest [main] nom de base utilisée => esignsante-psc
2021-12-24 08:53:10,133 INFO fr.ans.api.sign.esignsante.psc.storage.MongoDbTest [main] Recherche de la preuve stokée id_bdd: 61c57c6626ae266663b051fa
2021-12-24 08:53:10,137 INFO fr.ans.api.sign.esignsante.psc.storage.MongoDbTest [main] Test stokage recherche en BDD OK
2021-12-24 08:53:10,181 INFO org.springframework.boot.StartupInfoLogger [main] Starting EsignsantePscApplicationTest using Java 11.0.2 on NXQLX078 with PID 9944 (started by cjuillard in C:\Users\cjuillard\test\esignsantepsc)
2021-12-24 08:53:10,181 DEBUG org.springframework.boot.StartupInfoLogger [main] Running with Spring Boot v2.5.2, Spring v5.3.8
2021-12-24 08:53:10,182 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-12-24 08:53:10,729 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 08:53:10,731 INFO fr.ans.api.sign.esignsante.psc.config.MongoDBConfig [main] création d'une connexion à MongoDB avec   mongodb://localhost:27017 mongoDatabase: esignsante-psc
2021-12-24 08:53:10,735 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57c6626ae266663b051fb', description='null'}-localhost:27017] Opened connection [connectionId{localValue:23, serverValue:23}] to localhost:27017
2021-12-24 08:53:10,735 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57c6626ae266663b051fb', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=934600}
2021-12-24 08:53:10,736 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c57c6626ae266663b051fb', description='null'}-localhost:27017] Opened connection [connectionId{localValue:24, serverValue:24}] to localhost:27017
2021-12-24 08:53:11,509 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 08:53:11,513 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c57c6726ae266663b051fc', description='null'}-localhost:27017] Opened connection [connectionId{localValue:26, serverValue:25}] to localhost:27017
2021-12-24 08:53:11,513 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57c6726ae266663b051fc', description='null'}-localhost:27017] Opened connection [connectionId{localValue:25, serverValue:26}] to localhost:27017
2021-12-24 08:53:11,514 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c57c6726ae266663b051fc', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=1074600}
2021-12-24 08:53:11,690 INFO org.springframework.boot.StartupInfoLogger [main] Started EsignsantePscApplicationTest in 1.53 seconds (JVM running for 31.642)
2021-12-24 09:16:20,771 INFO org.springframework.test.context.support.AbstractTestContextBootstrapper [main] Neither @ContextConfiguration nor @ContextHierarchy found for test class [fr.ans.api.sign.esignsante.psc.api.DelegateMethodeInternalTest], using SpringBootContextLoader
2021-12-24 09:16:20,781 INFO org.springframework.test.context.support.AbstractContextLoader [main] Could not detect default resource locations for test class [fr.ans.api.sign.esignsante.psc.api.DelegateMethodeInternalTest]: no resource found for suffixes {-context.xml, Context.groovy}.
2021-12-24 09:16:20,782 INFO org.springframework.test.context.support.AnnotationConfigContextLoaderUtils [main] Could not detect default configuration classes for test class [fr.ans.api.sign.esignsante.psc.api.DelegateMethodeInternalTest]: DelegateMethodeInternalTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2021-12-24 09:16:20,987 INFO org.springframework.boot.test.context.SpringBootTestContextBootstrapper [main] Found @SpringBootConfiguration fr.ans.api.sign.esignsante.psc.OpenAPI2SpringBoot for test class fr.ans.api.sign.esignsante.psc.api.DelegateMethodeInternalTest
2021-12-24 09:16:21,150 INFO org.springframework.test.context.support.AbstractTestContextBootstrapper [main] Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.boot.test.mock.mockito.MockitoTestExecutionListener, org.springframework.boot.test.mock.mockito.ResetMocksTestExecutionListener, org.springframework.boot.test.autoconfigure.restdocs.RestDocsTestExecutionListener, org.springframework.boot.test.autoconfigure.web.client.MockRestServiceServerResetTestExecutionListener, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcPrintOnlyOnFailureTestExecutionListener, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverTestExecutionListener, org.springframework.boot.test.autoconfigure.webservices.client.MockWebServiceServerTestExecutionListener, org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.event.ApplicationEventsTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener, org.springframework.test.context.event.EventPublishingTestExecutionListener]
2021-12-24 09:16:21,173 INFO org.springframework.test.context.support.AbstractTestContextBootstrapper [main] Using TestExecutionListeners: [org.springframework.test.context.web.ServletTestExecutionListener@62f87c44, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@48f5bde6, org.springframework.test.context.event.ApplicationEventsTestExecutionListener@525d79f0, org.springframework.boot.test.mock.mockito.MockitoTestExecutionListener@5149f008, org.springframework.boot.test.autoconfigure.SpringBootDependencyInjectionTestExecutionListener@7072bc39, org.springframework.test.context.support.DirtiesContextTestExecutionListener@158d255c, org.springframework.test.context.transaction.TransactionalTestExecutionListener@2ca65ce4, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@327120c8, org.springframework.test.context.event.EventPublishingTestExecutionListener@5707c1cb, org.springframework.boot.test.mock.mockito.ResetMocksTestExecutionListener@2b5cb9b2, org.springframework.boot.test.autoconfigure.restdocs.RestDocsTestExecutionListener@35038141, org.springframework.boot.test.autoconfigure.web.client.MockRestServiceServerResetTestExecutionListener@ecf9049, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcPrintOnlyOnFailureTestExecutionListener@672f11c2, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverTestExecutionListener@2970a5bc, org.springframework.boot.test.autoconfigure.webservices.client.MockWebServiceServerTestExecutionListener@50305a]
2021-12-24 09:16:22,215 INFO org.springframework.boot.StartupInfoLogger [main] Starting DelegateMethodeInternalTest using Java 11.0.2 on NXQLX078 with PID 11316 (started by cjuillard in C:\Users\cjuillard\test\esignsantepsc)
2021-12-24 09:16:22,216 DEBUG org.springframework.boot.StartupInfoLogger [main] Running with Spring Boot v2.5.2, Spring v5.3.8
2021-12-24 09:16:22,219 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-12-24 09:16:24,881 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 09:16:24,938 INFO fr.ans.api.sign.esignsante.psc.config.MongoDBConfig [main] création d'une connexion à MongoDB avec   mongodb://localhost:27017 mongoDatabase: esignsante-psc
2021-12-24 09:16:24,967 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c581d885f79c283d46b7ca', description='null'}-localhost:27017] Opened connection [connectionId{localValue:2, serverValue:1}] to localhost:27017
2021-12-24 09:16:24,967 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c581d885f79c283d46b7ca', description='null'}-localhost:27017] Opened connection [connectionId{localValue:1, serverValue:2}] to localhost:27017
2021-12-24 09:16:24,970 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c581d885f79c283d46b7ca', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=26850400}
2021-12-24 09:16:28,429 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 09:16:28,438 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c581dc85f79c283d46b7cb', description='null'}-localhost:27017] Opened connection [connectionId{localValue:3, serverValue:3}] to localhost:27017
2021-12-24 09:16:28,438 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c581dc85f79c283d46b7cb', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=1575000}
2021-12-24 09:16:28,441 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c581dc85f79c283d46b7cb', description='null'}-localhost:27017] Opened connection [connectionId{localValue:4, serverValue:4}] to localhost:27017
2021-12-24 09:16:29,280 INFO org.springframework.boot.StartupInfoLogger [main] Started DelegateMethodeInternalTest in 7.416 seconds (JVM running for 9.717)
2021-12-24 09:16:29,442 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Requête en echec. Message retourné à l'utilisateur: Erreur dans la lecture du fichier reçu
2021-12-24 09:16:29,445 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] classe Exception: java.io.IOException
2021-12-24 09:16:29,446 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] cause de l'eException: {}
2021-12-24 09:16:29,447 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] message de l'exception null
2021-12-24 09:16:29,499 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Requête en echec. Message retourné à l'utilisateur: Erreur dans la lecture du fichier reçu
2021-12-24 09:16:29,499 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] classe Exception: java.io.IOException
2021-12-24 09:16:29,500 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] cause de l'eException: {}
2021-12-24 09:16:29,501 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] message de l'exception null
2021-12-24 09:16:29,569 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] signer: Délégataire de signature pour FamilyName (SubjectNameId)
2021-12-24 09:16:29,570 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] signer: Signé pour le compte de FamilyName (SubjectNameId)
2021-12-24 09:16:29,940 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Verification du fichier ipsfra.xml type detecté: application/xml
2021-12-24 09:16:29,941 DEBUG fr.ans.api.sign.esignsante.psc.api.DelegateMethodeTest [main] application/xml
2021-12-24 09:16:29,949 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Verification du fichier ANS.pdf type detecté: application/pdf
2021-12-24 09:16:29,954 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Verification du fichier empty.zzz type detecté: application/octet-stream
2021-12-24 09:16:29,959 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] java.io.FileNotFoundException: zzz (Le fichier spécifié est introuvable)
2021-12-24 09:16:29,961 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Requête en echec. Message retourné à l'utilisateur: Execption sur vérification du type de fichier transmis
2021-12-24 09:16:29,962 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] classe Exception: java.io.FileNotFoundException
2021-12-24 09:16:29,963 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] cause de l'eException: {}
2021-12-24 09:16:29,963 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] message de l'exception zzz (Le fichier spécifié est introuvable)
2021-12-24 09:16:29,982 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: ipsfra.xml. Use ipsfra.xml as name
2021-12-24 09:16:29,983 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile ipsfra.xml9529491561935541216.tmp
2021-12-24 09:16:29,986 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: ipsfra.xml9529491561935541216.tmp 	 length 2628
2021-12-24 09:16:30,003 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] retour appel esignsante OK pour un contrôle de signature - formatage de la réponse
2021-12-24 09:16:30,004 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] report false
2021-12-24 09:16:30,151 INFO org.springframework.boot.StartupInfoLogger [main] Starting AskApiIntegrationEsignWSOFFTest using Java 11.0.2 on NXQLX078 with PID 11316 (started by cjuillard in C:\Users\cjuillard\test\esignsantepsc)
2021-12-24 09:16:30,151 DEBUG org.springframework.boot.StartupInfoLogger [main] Running with Spring Boot v2.5.2, Spring v5.3.8
2021-12-24 09:16:30,158 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-12-24 09:16:31,073 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 09:16:31,075 INFO fr.ans.api.sign.esignsante.psc.config.MongoDBConfig [main] création d'une connexion à MongoDB avec   mongodb://localhost:27017 mongoDatabase: esignsante-psc
2021-12-24 09:16:31,080 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c581df85f79c283d46b7cc', description='null'}-localhost:27017] Opened connection [connectionId{localValue:5, serverValue:5}] to localhost:27017
2021-12-24 09:16:31,080 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c581df85f79c283d46b7cc', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=2349500}
2021-12-24 09:16:31,082 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c581df85f79c283d46b7cc', description='null'}-localhost:27017] Opened connection [connectionId{localValue:6, serverValue:6}] to localhost:27017
2021-12-24 09:16:32,762 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 09:16:32,782 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c581e085f79c283d46b7cd', description='null'}-localhost:27017] Opened connection [connectionId{localValue:7, serverValue:7}] to localhost:27017
2021-12-24 09:16:32,782 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c581e085f79c283d46b7cd', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=9534600}
2021-12-24 09:16:32,784 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c581e085f79c283d46b7cd', description='null'}-localhost:27017] Opened connection [connectionId{localValue:8, serverValue:8}] to localhost:27017
2021-12-24 09:16:33,199 INFO org.springframework.boot.StartupInfoLogger [main] Started AskApiIntegrationEsignWSOFFTest in 3.117 seconds (JVM running for 13.636)
2021-12-24 09:16:33,384 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Réception d'une demande de signature Xades
2021-12-24 09:16:33,388 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
}
2021-12-24 09:16:33,409 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  200 OK
2021-12-24 09:16:33,410 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel PSC intropesction: token= accessTokenValue  reponse PSC = {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-24 09:16:33,412 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: ipsfra.xml. Use ipsfra.xml as name
2021-12-24 09:16:33,413 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile ipsfra.xml5570496821067529866.tmp
2021-12-24 09:16:33,415 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: ipsfra.xml5570496821067529866.tmp 	 length 2628
2021-12-24 09:16:33,498 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Verification du fichier ipsfra.xml5570496821067529866.tmp type detecté: text/plain
2021-12-24 09:16:33,499 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Demande de signature valide: verif AccessToken OK: {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
, File OK ipsfra.xml5570496821067529866.tmp 
, userInfo OK Organisation: CABINET M SPECIALISTE0021889
2021-12-24 09:16:33,500 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] openidtoken[0] transmis à esignWS:
2021-12-24 09:16:33,501 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 userinfo (base64): eyJTZWN0ZXVyX0FjdGl2aXRlIjoiU0EwN14xLjIuMjUwLjEuNzEuNC4yLjQiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIlN1YmplY3RPcmdhbml6YXRpb24iOiJDQUJJTkVUIE0gU1BFQ0lBTElTVEUwMDIxODg5IiwicHJlZmVycmVkX3VzZXJuYW1lIjoiODk5NzAwMjE4ODk2IiwiZ2l2ZW5fbmFtZSI6IlJPQkVSVCIsIlN1YmplY3RSZWZQcm8iOnsiY29kZUNpdmlsaXRlIjoiTSIsImV4ZXJjaWNlcyI6W3siY29kZVByb2Zlc3Npb24iOiIxMCIsIm5vbURleGVyY2ljZSI6IlNQRUNJQUxJU1RFMDAyMTg4OSIsInByZW5vbURleGVyY2ljZSI6IlJPQkVSVCIsImNvZGVUeXBlU2F2b2lyRmFpcmUiOiIifV19LCJTdWJqZWN0Um9sZSI6WyIxMF4xLjIuMjUwLjEuMjEzLjEuMS41LjUiXSwiU3ViamVjdE5hbWVJRCI6Ijg5OTcwMDIxODg5NiIsImZhbWlseV9uYW1lIjoiU1BFQ0lBTElTVEUwMDIxODg5In0= 
2021-12-24 09:16:33,502 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 accessToken: accessTokenValue 
2021-12-24 09:16:33,503 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 PSCResponse: {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-24 09:16:33,504 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] signer: Délégataire de signature pour SPECIALISTE0021889 (899700218896)
2021-12-24 09:16:33,505 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel esignWS pour une signature de type XADES
2021-12-24 09:16:33,529 INFO fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] Appel esignante Webservices pour basePath = http://localhost:8081/esignsante/v1
2021-12-24 09:16:33,530 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] appel esignsanteWebservices pour une demande de signature en xades 
2021-12-24 09:16:33,530 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] fileToSign: ipsfra.xml5570496821067529866.tmp
2021-12-24 09:16:33,533 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] paramètres: basePath: http://localhost:8081/esignsante/v1 
 idSignConf: 1 
 proofConfId: 1 

2021-12-24 09:16:35,657 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Requête en echec. Message retourné à l'utilisateur: Exception sur appel esignWS. Service inaccessible
2021-12-24 09:16:35,658 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] classe Exception: org.springframework.web.client.ResourceAccessException
2021-12-24 09:16:35,661 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] cause de l'eException: {}
java.net.ConnectException: Connection refused: connect
	at java.base/java.net.PlainSocketImpl.connect0(Native Method)
	at java.base/java.net.PlainSocketImpl.socketConnect(PlainSocketImpl.java:101)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:399)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:242)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:224)
	at java.base/java.net.Socket.connect(Socket.java:591)
	at java.base/java.net.Socket.connect(Socket.java:540)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:182)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:474)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:569)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:242)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:341)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:362)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1242)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1181)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1075)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1009)
	at org.springframework.http.client.SimpleBufferingClientHttpRequest.executeInternal(SimpleBufferingClientHttpRequest.java:76)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.http.client.BufferingClientHttpRequestWrapper.executeInternal(BufferingClientHttpRequestWrapper.java:63)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:776)
	at org.springframework.web.client.RestTemplate.exchange(RestTemplate.java:670)
	at fr.ans.esignsante.ApiClient.invokeAPI(ApiClient.java:526)
	at fr.ans.esignsante.api.XadesApi.signatureXadesWithProof(XadesApi.java:207)
	at fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall.signatureXades(EsignsanteCall.java:56)
	at fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl.executeAskSignature(AsksignatureApiDelegateImpl.java:288)
	at fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl.postAsksignatureXades(AsksignatureApiDelegateImpl.java:129)
	at fr.ans.api.sign.esignsante.psc.api.AsksignatureApi.postAsksignatureXades(AsksignatureApi.java:91)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:894)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1063)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:681)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at org.springframework.test.web.servlet.TestDispatcherServlet.service(TestDispatcherServlet.java:72)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
	at org.springframework.mock.web.MockFilterChain$ServletFilterProxy.doFilter(MockFilterChain.java:167)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:134)
	at org.springframework.test.web.servlet.MockMvc.perform(MockMvc.java:183)
	at fr.ans.api.sign.esignsante.psc.api.requests.AskApiIntegrationEsignWSOFFTest.askSignXADES_esignWS_OFFTest(AskApiIntegrationEsignWSOFFTest.java:93)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:688)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:140)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:84)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$6(TestMethodTestDescriptor.java:210)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:206)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:131)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:65)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1540)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1540)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:32)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:51)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:220)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$6(DefaultLauncher.java:188)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:202)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:181)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:128)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:150)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2021-12-24 09:16:35,663 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] message de l'exception I/O error on POST request for "http://localhost:8081/esignsante/v1/signatures/xadesbaselinebwithproof": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect
2021-12-24 09:16:35,758 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Réception d'une demande de signature Pades
2021-12-24 09:16:35,760 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
}
2021-12-24 09:16:35,761 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  200 OK
2021-12-24 09:16:35,761 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel PSC intropesction: token= accessTokenValue  reponse PSC = {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-24 09:16:35,764 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: ANS.pdf. Use ANS.pdf as name
2021-12-24 09:16:35,765 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile ANS.pdf5845767866590686750.tmp
2021-12-24 09:16:35,769 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: ANS.pdf5845767866590686750.tmp 	 length 97996
2021-12-24 09:16:35,813 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Verification du fichier ANS.pdf5845767866590686750.tmp type detecté: application/pdf
2021-12-24 09:16:35,814 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Demande de signature valide: verif AccessToken OK: {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
, File OK ANS.pdf5845767866590686750.tmp 
, userInfo OK Organisation: CABINET M SPECIALISTE0021889
2021-12-24 09:16:35,815 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] openidtoken[0] transmis à esignWS:
2021-12-24 09:16:35,815 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 userinfo (base64): eyJTZWN0ZXVyX0FjdGl2aXRlIjoiU0EwN14xLjIuMjUwLjEuNzEuNC4yLjQiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIlN1YmplY3RPcmdhbml6YXRpb24iOiJDQUJJTkVUIE0gU1BFQ0lBTElTVEUwMDIxODg5IiwicHJlZmVycmVkX3VzZXJuYW1lIjoiODk5NzAwMjE4ODk2IiwiZ2l2ZW5fbmFtZSI6IlJPQkVSVCIsIlN1YmplY3RSZWZQcm8iOnsiY29kZUNpdmlsaXRlIjoiTSIsImV4ZXJjaWNlcyI6W3siY29kZVByb2Zlc3Npb24iOiIxMCIsIm5vbURleGVyY2ljZSI6IlNQRUNJQUxJU1RFMDAyMTg4OSIsInByZW5vbURleGVyY2ljZSI6IlJPQkVSVCIsImNvZGVUeXBlU2F2b2lyRmFpcmUiOiIifV19LCJTdWJqZWN0Um9sZSI6WyIxMF4xLjIuMjUwLjEuMjEzLjEuMS41LjUiXSwiU3ViamVjdE5hbWVJRCI6Ijg5OTcwMDIxODg5NiIsImZhbWlseV9uYW1lIjoiU1BFQ0lBTElTVEUwMDIxODg5In0= 
2021-12-24 09:16:35,816 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 accessToken: accessTokenValue 
2021-12-24 09:16:35,816 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 PSCResponse: {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-24 09:16:35,817 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] signer: Signé pour le compte de SPECIALISTE0021889 (899700218896)
2021-12-24 09:16:35,817 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel esignWS pour une signature de type PADES
2021-12-24 09:16:35,828 INFO fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] Appel esignante Webservices pour basePath = http://localhost:8081/esignsante/v1
2021-12-24 09:16:35,828 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] appel esignsanteWebservices pour une demande de signature en PADES 
2021-12-24 09:16:35,829 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] fileToSign: ANS.pdf5845767866590686750.tmp
2021-12-24 09:16:35,831 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] paramètres: basePath: http://localhost:8081/esignsante/v1 
 idSignConf: 1 
 proofConfId: 1 

2021-12-24 09:16:37,846 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Requête en echec. Message retourné à l'utilisateur: Exception sur appel esignWS. Service inaccessible
2021-12-24 09:16:37,846 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] classe Exception: org.springframework.web.client.ResourceAccessException
2021-12-24 09:16:37,847 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] cause de l'eException: {}
java.net.ConnectException: Connection refused: connect
	at java.base/java.net.PlainSocketImpl.connect0(Native Method)
	at java.base/java.net.PlainSocketImpl.socketConnect(PlainSocketImpl.java:101)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:399)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:242)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:224)
	at java.base/java.net.Socket.connect(Socket.java:591)
	at java.base/java.net.Socket.connect(Socket.java:540)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:182)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:474)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:569)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:242)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:341)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:362)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1242)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1181)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1075)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1009)
	at org.springframework.http.client.SimpleBufferingClientHttpRequest.executeInternal(SimpleBufferingClientHttpRequest.java:76)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.http.client.BufferingClientHttpRequestWrapper.executeInternal(BufferingClientHttpRequestWrapper.java:63)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:776)
	at org.springframework.web.client.RestTemplate.exchange(RestTemplate.java:670)
	at fr.ans.esignsante.ApiClient.invokeAPI(ApiClient.java:526)
	at fr.ans.esignsante.api.PadesApi.signaturePadesWithProof(PadesApi.java:207)
	at fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall.signaturePades(EsignsanteCall.java:77)
	at fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl.executeAskSignature(AsksignatureApiDelegateImpl.java:286)
	at fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl.postAskSignaturePades(AsksignatureApiDelegateImpl.java:92)
	at fr.ans.api.sign.esignsante.psc.api.AsksignatureApi.postAskSignaturePades(AsksignatureApi.java:58)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:894)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1063)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:681)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at org.springframework.test.web.servlet.TestDispatcherServlet.service(TestDispatcherServlet.java:72)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
	at org.springframework.mock.web.MockFilterChain$ServletFilterProxy.doFilter(MockFilterChain.java:167)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:134)
	at org.springframework.test.web.servlet.MockMvc.perform(MockMvc.java:183)
	at fr.ans.api.sign.esignsante.psc.api.requests.AskApiIntegrationEsignWSOFFTest.askSignPADES_esignWS_OFFTest(AskApiIntegrationEsignWSOFFTest.java:130)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:688)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:140)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:84)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$6(TestMethodTestDescriptor.java:210)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:206)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:131)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:65)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1540)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1540)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:32)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:51)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:220)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$6(DefaultLauncher.java:188)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:202)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:181)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:128)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:150)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2021-12-24 09:16:37,848 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] message de l'exception I/O error on POST request for "http://localhost:8081/esignsante/v1/signatures/padesbaselinebwithproof": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect
2021-12-24 09:16:37,965 INFO org.springframework.boot.StartupInfoLogger [main] Starting AskApiIntegrationTest using Java 11.0.2 on NXQLX078 with PID 11316 (started by cjuillard in C:\Users\cjuillard\test\esignsantepsc)
2021-12-24 09:16:37,966 DEBUG org.springframework.boot.StartupInfoLogger [main] Running with Spring Boot v2.5.2, Spring v5.3.8
2021-12-24 09:16:37,967 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-12-24 09:16:38,723 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 09:16:38,726 INFO fr.ans.api.sign.esignsante.psc.config.MongoDBConfig [main] création d'une connexion à MongoDB avec   mongodb://localhost:27017 mongoDatabase: esignsante-psc
2021-12-24 09:16:38,730 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c581e685f79c283d46b7ce', description='null'}-localhost:27017] Opened connection [connectionId{localValue:9, serverValue:9}] to localhost:27017
2021-12-24 09:16:38,732 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c581e685f79c283d46b7ce', description='null'}-localhost:27017] Opened connection [connectionId{localValue:10, serverValue:10}] to localhost:27017
2021-12-24 09:16:38,732 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c581e685f79c283d46b7ce', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=3397500}
2021-12-24 09:16:39,958 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 09:16:39,963 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c581e785f79c283d46b7cf', description='null'}-localhost:27017] Opened connection [connectionId{localValue:12, serverValue:12}] to localhost:27017
2021-12-24 09:16:39,963 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c581e785f79c283d46b7cf', description='null'}-localhost:27017] Opened connection [connectionId{localValue:11, serverValue:11}] to localhost:27017
2021-12-24 09:16:39,964 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c581e785f79c283d46b7cf', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=1120900}
2021-12-24 09:16:40,267 INFO org.springframework.boot.StartupInfoLogger [main] Started AskApiIntegrationTest in 2.347 seconds (JVM running for 20.703)
2021-12-24 09:16:40,282 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Réception d'une demande de signature Pades
2021-12-24 09:16:40,284 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
}
2021-12-24 09:16:40,285 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  200 OK
2021-12-24 09:16:40,286 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel PSC intropesction: token= accessTokenValue  reponse PSC = {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-24 09:16:40,287 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: ipsfra.xml. Use ipsfra.xml as name
2021-12-24 09:16:40,288 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile ipsfra.xml6043012243645561873.tmp
2021-12-24 09:16:40,289 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: ipsfra.xml6043012243645561873.tmp 	 length 2628
2021-12-24 09:16:40,301 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Verification du fichier ipsfra.xml6043012243645561873.tmp type detecté: text/plain
2021-12-24 09:16:40,353 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Réception d'une demande de signature Xades
2021-12-24 09:16:40,356 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
}
2021-12-24 09:16:40,357 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  200 OK
2021-12-24 09:16:40,359 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel PSC intropesction: token= accessTokenValue  reponse PSC = {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-24 09:16:40,359 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: ipsfra.xml. Use ipsfra.xml as name
2021-12-24 09:16:40,360 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile ipsfra.xml7301497209551280959.tmp
2021-12-24 09:16:40,362 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: ipsfra.xml7301497209551280959.tmp 	 length 2628
2021-12-24 09:16:40,372 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Verification du fichier ipsfra.xml7301497209551280959.tmp type detecté: text/plain
2021-12-24 09:16:40,373 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Demande de signature valide: verif AccessToken OK: {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
, File OK ipsfra.xml7301497209551280959.tmp 
, userInfo OK Organisation: CABINET M SPECIALISTE0021889
2021-12-24 09:16:40,374 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] openidtoken[0] transmis à esignWS:
2021-12-24 09:16:40,374 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 userinfo (base64): eyJTZWN0ZXVyX0FjdGl2aXRlIjoiU0EwN14xLjIuMjUwLjEuNzEuNC4yLjQiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIlN1YmplY3RPcmdhbml6YXRpb24iOiJDQUJJTkVUIE0gU1BFQ0lBTElTVEUwMDIxODg5IiwicHJlZmVycmVkX3VzZXJuYW1lIjoiODk5NzAwMjE4ODk2IiwiZ2l2ZW5fbmFtZSI6IlJPQkVSVCIsIlN1YmplY3RSZWZQcm8iOnsiY29kZUNpdmlsaXRlIjoiTSIsImV4ZXJjaWNlcyI6W3siY29kZVByb2Zlc3Npb24iOiIxMCIsIm5vbURleGVyY2ljZSI6IlNQRUNJQUxJU1RFMDAyMTg4OSIsInByZW5vbURleGVyY2ljZSI6IlJPQkVSVCIsImNvZGVUeXBlU2F2b2lyRmFpcmUiOiIifV19LCJTdWJqZWN0Um9sZSI6WyIxMF4xLjIuMjUwLjEuMjEzLjEuMS41LjUiXSwiU3ViamVjdE5hbWVJRCI6Ijg5OTcwMDIxODg5NiIsImZhbWlseV9uYW1lIjoiU1BFQ0lBTElTVEUwMDIxODg5In0= 
2021-12-24 09:16:40,375 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 accessToken: accessTokenValue 
2021-12-24 09:16:40,376 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 PSCResponse: {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-24 09:16:40,377 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] signer: Délégataire de signature pour SPECIALISTE0021889 (899700218896)
2021-12-24 09:16:40,377 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel esignWS pour une signature de type XADES
2021-12-24 09:16:40,379 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main]  START archivage de la preuve en BDD pour request id: f1cf9e10-7b83-407b-9ab6-027d30b43457
2021-12-24 09:16:40,380 DEBUG fr.ans.api.sign.esignsante.psc.storage.repository.PreuveDAOImpl [main] demande persistence de la preuve d'une demande de signature pour: 
  SubjectOrganization: CABINET M SPECIALISTE0021889 
  Preferred_username: 899700218896 
 Given_name: ROBERT 
Family_name:SPECIALISTE0021889  
 Timestamp (acceptation de la reqête): Fri Dec 24 09:16:40 CET 2021   
2021-12-24 09:16:40,442 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Opened connection [connectionId{localValue:13, serverValue:13}] to localhost:27017
2021-12-24 09:16:40,491 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Fin archivage de la preuve en BDD pour request id: f1cf9e10-7b83-407b-9ab6-027d30b43457
2021-12-24 09:16:40,565 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Réception d'une demande de signature Pades
2021-12-24 09:16:40,566 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {
    "active": false
}
2021-12-24 09:16:40,567 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  401 UNAUTHORIZED
2021-12-24 09:16:40,567 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel PSC intropesction: token= accessTokenValue  reponse PSC = {
    "active": false
} 
2021-12-24 09:16:40,607 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Réception d'une demande de signature Xades
2021-12-24 09:16:40,609 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {
    "active": false
}
2021-12-24 09:16:40,610 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  401 UNAUTHORIZED
2021-12-24 09:16:40,610 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel PSC intropesction: token= accessTokenValue  reponse PSC = {
    "active": false
} 
2021-12-24 09:16:40,639 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Réception d'une demande de signature Pades
2021-12-24 09:16:40,640 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
}
2021-12-24 09:16:40,642 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  200 OK
2021-12-24 09:16:40,642 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel PSC intropesction: token= accessTokenValue  reponse PSC = {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-24 09:16:40,644 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: ANS.pdf. Use ANS.pdf as name
2021-12-24 09:16:40,645 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile ANS.pdf17949832467467378894.tmp
2021-12-24 09:16:40,647 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: ANS.pdf17949832467467378894.tmp 	 length 97996
2021-12-24 09:16:40,694 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Verification du fichier ANS.pdf17949832467467378894.tmp type detecté: application/pdf
2021-12-24 09:16:40,695 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Demande de signature valide: verif AccessToken OK: {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
, File OK ANS.pdf17949832467467378894.tmp 
, userInfo OK Organisation: CABINET M SPECIALISTE0021889
2021-12-24 09:16:40,695 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] openidtoken[0] transmis à esignWS:
2021-12-24 09:16:40,695 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 userinfo (base64): eyJTZWN0ZXVyX0FjdGl2aXRlIjoiU0EwN14xLjIuMjUwLjEuNzEuNC4yLjQiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIlN1YmplY3RPcmdhbml6YXRpb24iOiJDQUJJTkVUIE0gU1BFQ0lBTElTVEUwMDIxODg5IiwicHJlZmVycmVkX3VzZXJuYW1lIjoiODk5NzAwMjE4ODk2IiwiZ2l2ZW5fbmFtZSI6IlJPQkVSVCIsIlN1YmplY3RSZWZQcm8iOnsiY29kZUNpdmlsaXRlIjoiTSIsImV4ZXJjaWNlcyI6W3siY29kZVByb2Zlc3Npb24iOiIxMCIsIm5vbURleGVyY2ljZSI6IlNQRUNJQUxJU1RFMDAyMTg4OSIsInByZW5vbURleGVyY2ljZSI6IlJPQkVSVCIsImNvZGVUeXBlU2F2b2lyRmFpcmUiOiIifV19LCJTdWJqZWN0Um9sZSI6WyIxMF4xLjIuMjUwLjEuMjEzLjEuMS41LjUiXSwiU3ViamVjdE5hbWVJRCI6Ijg5OTcwMDIxODg5NiIsImZhbWlseV9uYW1lIjoiU1BFQ0lBTElTVEUwMDIxODg5In0= 
2021-12-24 09:16:40,696 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 accessToken: accessTokenValue 
2021-12-24 09:16:40,696 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 PSCResponse: {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-24 09:16:40,696 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] signer: Signé pour le compte de SPECIALISTE0021889 (899700218896)
2021-12-24 09:16:40,697 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel esignWS pour une signature de type PADES
2021-12-24 09:16:40,697 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main]  START archivage de la preuve en BDD pour request id: dc07c308-d8a8-479f-8298-ab94f84591ac
2021-12-24 09:16:40,698 DEBUG fr.ans.api.sign.esignsante.psc.storage.repository.PreuveDAOImpl [main] demande persistence de la preuve d'une demande de signature pour: 
  SubjectOrganization: CABINET M SPECIALISTE0021889 
  Preferred_username: 899700218896 
 Given_name: ROBERT 
Family_name:SPECIALISTE0021889  
 Timestamp (acceptation de la reqête): Fri Dec 24 09:16:40 CET 2021   
2021-12-24 09:16:40,700 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Fin archivage de la preuve en BDD pour request id: dc07c308-d8a8-479f-8298-ab94f84591ac
2021-12-24 09:16:40,742 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Réception d'une demande des CAs
2021-12-24 09:16:40,750 INFO fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] Appel esignante Webservices pour basePath = http://localhost:8081/esignsante/v1
2021-12-24 09:16:42,800 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Requête en echec. Message retourné à l'utilisateur: Exception sur appel esignWS. Service inaccessible
2021-12-24 09:16:42,802 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] classe Exception: org.springframework.web.client.ResourceAccessException
2021-12-24 09:16:42,804 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] cause de l'eException: {}
java.net.ConnectException: Connection refused: connect
	at java.base/java.net.PlainSocketImpl.connect0(Native Method)
	at java.base/java.net.PlainSocketImpl.socketConnect(PlainSocketImpl.java:101)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:399)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:242)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:224)
	at java.base/java.net.Socket.connect(Socket.java:591)
	at java.base/java.net.Socket.connect(Socket.java:540)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:182)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:474)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:569)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:242)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:341)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:362)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1242)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1181)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1075)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1009)
	at org.springframework.http.client.SimpleBufferingClientHttpRequest.executeInternal(SimpleBufferingClientHttpRequest.java:76)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.http.client.BufferingClientHttpRequestWrapper.executeInternal(BufferingClientHttpRequestWrapper.java:63)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:776)
	at org.springframework.web.client.RestTemplate.exchange(RestTemplate.java:670)
	at fr.ans.esignsante.ApiClient.invokeAPI(ApiClient.java:526)
	at fr.ans.esignsante.api.CaApi.getCA(CaApi.java:73)
	at fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall.getCA(EsignsanteCall.java:124)
	at fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl.getCa(CaApiDelegateImpl.java:40)
	at fr.ans.api.sign.esignsante.psc.api.CaApi.getCa(CaApi.java:46)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:894)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1063)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:655)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at org.springframework.test.web.servlet.TestDispatcherServlet.service(TestDispatcherServlet.java:72)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
	at org.springframework.mock.web.MockFilterChain$ServletFilterProxy.doFilter(MockFilterChain.java:167)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:134)
	at org.springframework.test.web.servlet.MockMvc.perform(MockMvc.java:183)
	at fr.ans.api.sign.esignsante.psc.api.requests.CAApiIntegrationEsignWSOFFTest.caGet_esignWS_OFFTest(CAApiIntegrationEsignWSOFFTest.java:52)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:688)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:140)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:84)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$6(TestMethodTestDescriptor.java:210)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:206)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:131)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:65)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1540)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1540)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:32)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:51)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:220)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$6(DefaultLauncher.java:188)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:202)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:181)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:128)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:150)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2021-12-24 09:16:42,808 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] message de l'exception I/O error on GET request for "http://localhost:8081/esignsante/v1/ca": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect
2021-12-24 09:16:42,900 INFO org.springframework.boot.StartupInfoLogger [main] Starting CAApiIntegrationTest using Java 11.0.2 on NXQLX078 with PID 11316 (started by cjuillard in C:\Users\cjuillard\test\esignsantepsc)
2021-12-24 09:16:42,901 DEBUG org.springframework.boot.StartupInfoLogger [main] Running with Spring Boot v2.5.2, Spring v5.3.8
2021-12-24 09:16:42,902 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-12-24 09:16:43,588 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 09:16:43,590 INFO fr.ans.api.sign.esignsante.psc.config.MongoDBConfig [main] création d'une connexion à MongoDB avec   mongodb://localhost:27017 mongoDatabase: esignsante-psc
2021-12-24 09:16:43,592 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c581eb85f79c283d46b7d2', description='null'}-localhost:27017] Opened connection [connectionId{localValue:15, serverValue:14}] to localhost:27017
2021-12-24 09:16:43,594 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c581eb85f79c283d46b7d2', description='null'}-localhost:27017] Opened connection [connectionId{localValue:14, serverValue:15}] to localhost:27017
2021-12-24 09:16:43,594 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c581eb85f79c283d46b7d2', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=2541000}
2021-12-24 09:16:44,537 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 09:16:44,543 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c581ec85f79c283d46b7d3', description='null'}-localhost:27017] Opened connection [connectionId{localValue:16, serverValue:16}] to localhost:27017
2021-12-24 09:16:44,543 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c581ec85f79c283d46b7d3', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=1223300}
2021-12-24 09:16:44,545 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c581ec85f79c283d46b7d3', description='null'}-localhost:27017] Opened connection [connectionId{localValue:17, serverValue:17}] to localhost:27017
2021-12-24 09:16:44,771 INFO org.springframework.boot.StartupInfoLogger [main] Started CAApiIntegrationTest in 1.918 seconds (JVM running for 25.208)
2021-12-24 09:16:44,797 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Réception d'une demande des CAs
2021-12-24 09:16:44,798 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Demande des CAs traitée avec succès
2021-12-24 09:16:44,818 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Réception d'une demande des CAs
2021-12-24 09:16:44,819 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Demande des CAs traitée avec succès
2021-12-24 09:16:44,822 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Réception d'une demande des CAs
2021-12-24 09:16:44,823 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Demande des CAs traitée avec succès
2021-12-24 09:16:44,826 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Réception d'une demande des CAs
2021-12-24 09:16:44,827 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Demande des CAs traitée avec succès
2021-12-24 09:16:44,836 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Réception d'une demande des CAs
2021-12-24 09:16:44,837 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Demande des CAs traitée avec succès
2021-12-24 09:16:44,856 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Réception d'une demande des CAs
2021-12-24 09:16:44,857 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Demande des CAs traitée avec succès
2021-12-24 09:16:44,895 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Demande Checksignature Pades reçue
2021-12-24 09:16:44,896 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: signedipsfra.xml. Use signedipsfra.xml as name
2021-12-24 09:16:44,897 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile signedipsfra.xml15958423223178289817.tmp
2021-12-24 09:16:44,899 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: signedipsfra.xml15958423223178289817.tmp 	 length 10239
2021-12-24 09:16:44,901 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] message 501 501 

2021-12-24 09:16:44,901 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] toString org.springframework.web.client.HttpServerErrorException$NotImplemented: 501 501 

2021-12-24 09:16:44,902 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] class Name org.springframework.web.client.HttpServerErrorException$NotImplemented 

2021-12-24 09:16:44,903 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] class Canonicalname org.springframework.web.client.HttpServerErrorException.NotImplemented 

2021-12-24 09:16:44,904 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Echec de l'appel à esignsanteWS => HttpServerErrorException.NotImplemented
2021-12-24 09:16:44,925 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Réception d'une demande Checksignature Pades.
2021-12-24 09:16:44,927 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: ANS_SIGNED.pdf. Use ANS_SIGNED.pdf as name
2021-12-24 09:16:44,927 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile ANS_SIGNED.pdf7270360377696902474.tmp
2021-12-24 09:16:44,929 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: ANS_SIGNED.pdf7270360377696902474.tmp 	 length 118076
2021-12-24 09:16:44,930 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] message 501 501 

2021-12-24 09:16:44,931 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] toString org.springframework.web.client.HttpServerErrorException$NotImplemented: 501 501 

2021-12-24 09:16:44,932 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] class Name org.springframework.web.client.HttpServerErrorException$NotImplemented 

2021-12-24 09:16:44,932 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] class Canonicalname org.springframework.web.client.HttpServerErrorException.NotImplemented 

2021-12-24 09:16:44,933 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Echec de l'appel à esignsanteWS => HttpServerErrorException.NotImplemented
2021-12-24 09:16:44,979 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Réception d'une demande Checksignature Pades.
2021-12-24 09:16:44,980 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: . Use  as name
2021-12-24 09:16:44,981 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile 7474937120037159225.tmp
2021-12-24 09:16:44,982 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: 7474937120037159225.tmp 	 length 32158
2021-12-24 09:16:44,991 INFO fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] Appel esignante Webservices pour basePath = http://localhost:8081/esignsante/v1
2021-12-24 09:16:44,992 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] appel esignsanteWebservices pour une VERIF de signature en xades
2021-12-24 09:16:44,998 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] paramètres: basePath: http://localhost:8081/esignsante/v1 id checkSign d esignsante: 1 file: 7474937120037159225.tmp
2021-12-24 09:16:44,999 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] fileExist:true
2021-12-24 09:16:47,045 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] message I/O error on POST request for "http://localhost:8081/esignsante/v1/validation/signatures/xadesbaselineb": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect 

2021-12-24 09:16:47,046 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] toString org.springframework.web.client.ResourceAccessException: I/O error on POST request for "http://localhost:8081/esignsante/v1/validation/signatures/xadesbaselineb": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect 

2021-12-24 09:16:47,047 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] class Name org.springframework.web.client.ResourceAccessException 

2021-12-24 09:16:47,047 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] class Canonicalname org.springframework.web.client.ResourceAccessException 

2021-12-24 09:16:47,048 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Exception sur appel esignWS. Service inaccessible
2021-12-24 09:16:47,101 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Demande Checksignature Pades reçue
2021-12-24 09:16:47,102 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: . Use  as name
2021-12-24 09:16:47,103 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile 13431443869710749032.tmp
2021-12-24 09:16:47,105 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: 13431443869710749032.tmp 	 length 118076
2021-12-24 09:16:47,114 INFO fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] Appel esignante Webservices pour basePath = http://localhost:8081/esignsante/v1
2021-12-24 09:16:47,115 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] appel esignsanteWebservices pour une VERIF de signature en PADES
2021-12-24 09:16:47,116 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] paramètres: basePath: http://localhost:8081/esignsante/v1 id checkSign d esignsante: 1 file: 13431443869710749032.tmp
2021-12-24 09:16:47,117 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] fileExist:true
2021-12-24 09:16:49,204 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] message I/O error on POST request for "http://localhost:8081/esignsante/v1/validation/signatures/padesbaselineb": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect 

2021-12-24 09:16:49,205 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] toString org.springframework.web.client.ResourceAccessException: I/O error on POST request for "http://localhost:8081/esignsante/v1/validation/signatures/padesbaselineb": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect 

2021-12-24 09:16:49,207 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] class Name org.springframework.web.client.ResourceAccessException 

2021-12-24 09:16:49,209 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] class Canonicalname org.springframework.web.client.ResourceAccessException 

2021-12-24 09:16:49,211 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Exception sur appel esignWS. Service inaccessible
2021-12-24 09:16:49,301 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Demande Checksignature Pades reçue
2021-12-24 09:16:49,302 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: ANS_SIGNED.pdf. Use ANS_SIGNED.pdf as name
2021-12-24 09:16:49,303 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile ANS_SIGNED.pdf7741874798498888624.tmp
2021-12-24 09:16:49,305 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: ANS_SIGNED.pdf7741874798498888624.tmp 	 length 118076
2021-12-24 09:16:49,307 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] retour appel esignsante OK pour un contrôle de signature - formatage de la réponse
2021-12-24 09:16:49,308 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] report true
2021-12-24 09:16:49,340 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Réception d'une demande Checksignature Pades.
2021-12-24 09:16:49,341 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: signedipsfra.xml. Use signedipsfra.xml as name
2021-12-24 09:16:49,341 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile signedipsfra.xml3086229506679461487.tmp
2021-12-24 09:16:49,343 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: signedipsfra.xml3086229506679461487.tmp 	 length 10239
2021-12-24 09:16:49,344 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] retour appel esignsante OK pour un contrôle de signature - formatage de la réponse
2021-12-24 09:16:49,344 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] report true
2021-12-24 09:16:49,383 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.DefaultApiDelegateImpl [main] Réception d'une demande des opérations disponibles
2021-12-24 09:16:49,413 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.DefaultApiDelegateImpl [main] Réception d'une demande des opérations disponibles
2021-12-24 09:16:49,481 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.DefaultApiDelegateImpl [main] Réception d'une demande des opérations disponibles
2021-12-24 09:16:49,555 INFO org.springframework.boot.StartupInfoLogger [main] Starting HelperTest using Java 11.0.2 on NXQLX078 with PID 11316 (started by cjuillard in C:\Users\cjuillard\test\esignsantepsc)
2021-12-24 09:16:49,555 DEBUG org.springframework.boot.StartupInfoLogger [main] Running with Spring Boot v2.5.2, Spring v5.3.8
2021-12-24 09:16:49,557 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-12-24 09:16:50,140 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 09:16:50,142 INFO fr.ans.api.sign.esignsante.psc.config.MongoDBConfig [main] création d'une connexion à MongoDB avec   mongodb://localhost:27017 mongoDatabase: esignsante-psc
2021-12-24 09:16:50,145 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c581f285f79c283d46b7d4', description='null'}-localhost:27017] Opened connection [connectionId{localValue:18, serverValue:19}] to localhost:27017
2021-12-24 09:16:50,146 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c581f285f79c283d46b7d4', description='null'}-localhost:27017] Opened connection [connectionId{localValue:19, serverValue:18}] to localhost:27017
2021-12-24 09:16:50,147 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c581f285f79c283d46b7d4', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=1481900}
2021-12-24 09:16:51,049 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 09:16:51,053 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c581f385f79c283d46b7d5', description='null'}-localhost:27017] Opened connection [connectionId{localValue:21, serverValue:21}] to localhost:27017
2021-12-24 09:16:51,053 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c581f385f79c283d46b7d5', description='null'}-localhost:27017] Opened connection [connectionId{localValue:20, serverValue:20}] to localhost:27017
2021-12-24 09:16:51,053 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c581f385f79c283d46b7d5', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=844200}
2021-12-24 09:16:51,338 INFO org.springframework.boot.StartupInfoLogger [main] Started HelperTest in 1.815 seconds (JVM running for 31.775)
2021-12-24 09:16:51,350 DEBUG fr.ans.api.sign.esignsante.psc.api.utils.HelperTest [main] encodebase64
2021-12-24 09:16:51,350 DEBUG fr.ans.api.sign.esignsante.psc.api.utils.HelperTest [main] Q2hhw65uZSBkZSBjYXJhY3TDqHJlIFVURjggJsOpIigsOyE=
2021-12-24 09:16:51,358 DEBUG fr.ans.api.sign.esignsante.psc.api.utils.HelperTest [main] test conversion Erreur(esignsante) en Error (esigsante-psc
2021-12-24 09:16:51,360 DEBUG fr.ans.api.sign.esignsante.psc.api.utils.HelperTest [main] code :codeErreur1 msg :message1
2021-12-24 09:16:51,361 DEBUG fr.ans.api.sign.esignsante.psc.api.utils.HelperTest [main] code :codeErreur2 msg :message2
2021-12-24 09:16:51,369 DEBUG fr.ans.api.sign.esignsante.psc.api.utils.HelperTest [main] decodebase64
2021-12-24 09:16:51,370 DEBUG fr.ans.api.sign.esignsante.psc.api.utils.HelperTest [main] Chaîne de caractère UTF8 &é"(,;!
2021-12-24 09:16:51,375 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
}
2021-12-24 09:16:51,376 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  200 OK
2021-12-24 09:16:51,376 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {"active":false}
2021-12-24 09:16:51,377 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  401 UNAUTHORIZED
2021-12-24 09:16:51,377 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with Mauvaise réponse..
2021-12-24 09:16:51,378 ERROR fr.ans.api.sign.esignsante.psc.utils.Helper [main] Erreur technique durant le parse de la reponse d'intropection PSC: champ Unrecognized token 'Mauvaise': was expecting (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (String)"Mauvaise réponse.."; line: 1, column: 9] 
2021-12-24 09:16:51,378 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] com.fasterxml.jackson.core.JsonParseException: Unrecognized token 'Mauvaise': was expecting (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (String)"Mauvaise réponse.."; line: 1, column: 9]
2021-12-24 09:16:51,379 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  500 INTERNAL_SERVER_ERROR
2021-12-24 09:16:51,430 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Opened connection [connectionId{localValue:22, serverValue:22}] to localhost:27017
2021-12-24 09:16:51,437 INFO fr.ans.api.sign.esignsante.psc.storage.MongoDbTest [main] *** Test d'écriture ProofStorage dans MongoDB
2021-12-24 09:16:51,438 INFO fr.ans.api.sign.esignsante.psc.storage.MongoDbTest [main] nom de base utilisée => esignsante-psc
2021-12-24 09:16:51,521 INFO fr.ans.api.sign.esignsante.psc.storage.MongoDbTest [main] Recherche de la preuve stokée id_bdd: 61c581f385f79c283d46b7d6
2021-12-24 09:16:51,525 INFO fr.ans.api.sign.esignsante.psc.storage.MongoDbTest [main] Test stokage recherche en BDD OK
2021-12-24 09:16:51,561 INFO org.springframework.boot.StartupInfoLogger [main] Starting EsignsantePscApplicationTest using Java 11.0.2 on NXQLX078 with PID 11316 (started by cjuillard in C:\Users\cjuillard\test\esignsantepsc)
2021-12-24 09:16:51,562 DEBUG org.springframework.boot.StartupInfoLogger [main] Running with Spring Boot v2.5.2, Spring v5.3.8
2021-12-24 09:16:51,563 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-12-24 09:16:52,199 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 09:16:52,200 INFO fr.ans.api.sign.esignsante.psc.config.MongoDBConfig [main] création d'une connexion à MongoDB avec   mongodb://localhost:27017 mongoDatabase: esignsante-psc
2021-12-24 09:16:52,203 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c581f485f79c283d46b7d7', description='null'}-localhost:27017] Opened connection [connectionId{localValue:23, serverValue:24}] to localhost:27017
2021-12-24 09:16:52,203 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c581f485f79c283d46b7d7', description='null'}-localhost:27017] Opened connection [connectionId{localValue:24, serverValue:23}] to localhost:27017
2021-12-24 09:16:52,203 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c581f485f79c283d46b7d7', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=1054700}
2021-12-24 09:16:53,187 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-24 09:16:53,191 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c581f585f79c283d46b7d8', description='null'}-localhost:27017] Opened connection [connectionId{localValue:26, serverValue:25}] to localhost:27017
2021-12-24 09:16:53,191 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c581f585f79c283d46b7d8', description='null'}-localhost:27017] Opened connection [connectionId{localValue:25, serverValue:26}] to localhost:27017
2021-12-24 09:16:53,192 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c581f585f79c283d46b7d8', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=1115900}
2021-12-24 09:16:53,364 INFO org.springframework.boot.StartupInfoLogger [main] Started EsignsantePscApplicationTest in 1.825 seconds (JVM running for 33.801)
