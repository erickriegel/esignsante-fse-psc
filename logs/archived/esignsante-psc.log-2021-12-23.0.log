2021-12-23 19:48:38,904 INFO org.springframework.boot.StartupInfoLogger [main] Starting DelegateMethodeInternalTest using Java 11.0.2 on NXQLX078 with PID 13992 (started by cjuillard in C:\Users\cjuillard\test\esignsantepsc)
2021-12-23 19:48:38,905 DEBUG org.springframework.boot.StartupInfoLogger [main] Running with Spring Boot v2.5.2, Spring v5.3.8
2021-12-23 19:48:38,908 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-12-23 19:48:41,726 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-23 19:48:41,782 INFO fr.ans.api.sign.esignsante.psc.config.MongoDBConfig [main] création d'une connexion à MongoDB avec   mongodb://localhost:27017 mongoDatabase: esignsante-psc
2021-12-23 19:48:41,814 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c4c489f118145e37745b9a', description='null'}-localhost:27017] Opened connection [connectionId{localValue:1, serverValue:2}] to localhost:27017
2021-12-23 19:48:41,814 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c4c489f118145e37745b9a', description='null'}-localhost:27017] Opened connection [connectionId{localValue:2, serverValue:1}] to localhost:27017
2021-12-23 19:48:41,818 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c4c489f118145e37745b9a', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=27562100}
2021-12-23 19:48:44,736 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-23 19:48:44,744 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c4c48cf118145e37745b9b', description='null'}-localhost:27017] Opened connection [connectionId{localValue:4, serverValue:3}] to localhost:27017
2021-12-23 19:48:44,747 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c4c48cf118145e37745b9b', description='null'}-localhost:27017] Opened connection [connectionId{localValue:3, serverValue:4}] to localhost:27017
2021-12-23 19:48:44,748 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c4c48cf118145e37745b9b', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=4596300}
2021-12-23 19:48:45,426 INFO org.springframework.boot.StartupInfoLogger [main] Started DelegateMethodeInternalTest in 6.983 seconds (JVM running for 9.005)
2021-12-23 19:48:45,567 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Requête en echec. Message retourné à l'utilisateur: Erreur dans la lecture du fichier reçu
2021-12-23 19:48:45,569 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] classe Exception: java.io.IOException
2021-12-23 19:48:45,570 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] cause de l'eException: {}
2021-12-23 19:48:45,571 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] message de l'exception null
2021-12-23 19:48:45,632 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Requête en echec. Message retourné à l'utilisateur: Erreur dans la lecture du fichier reçu
2021-12-23 19:48:45,633 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] classe Exception: java.io.IOException
2021-12-23 19:48:45,633 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] cause de l'eException: {}
2021-12-23 19:48:45,634 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] message de l'exception null
2021-12-23 19:48:45,687 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] signer: Délégataire de signature pour FamilyName (SubjectNameId)
2021-12-23 19:48:45,692 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] signer: Signé pour le compte de FamilyName (SubjectNameId)
2021-12-23 19:48:45,945 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Verification du fichier ipsfra.xml type detecté: application/xml
2021-12-23 19:48:45,946 DEBUG fr.ans.api.sign.esignsante.psc.api.DelegateMethodeTest [main] application/xml
2021-12-23 19:48:45,951 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Verification du fichier ANS.pdf type detecté: application/pdf
2021-12-23 19:48:45,954 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Verification du fichier empty.zzz type detecté: application/octet-stream
2021-12-23 19:48:45,960 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] java.io.FileNotFoundException: zzz (Le fichier spécifié est introuvable)
2021-12-23 19:48:45,961 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Requête en echec. Message retourné à l'utilisateur: Execption sur vérification du type de fichier transmis
2021-12-23 19:48:45,962 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] classe Exception: java.io.FileNotFoundException
2021-12-23 19:48:45,962 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] cause de l'eException: {}
2021-12-23 19:48:45,963 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] message de l'exception zzz (Le fichier spécifié est introuvable)
2021-12-23 19:48:45,987 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: ipsfra.xml. Use ipsfra.xml as name
2021-12-23 19:48:45,989 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile ipsfra.xml9953549617967509856.tmp
2021-12-23 19:48:45,993 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: ipsfra.xml9953549617967509856.tmp 	 length 2628
2021-12-23 19:48:46,012 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] retour appel esignsante OK pour un contrôle de signature - formatage de la réponse
2021-12-23 19:48:46,013 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] report false
2021-12-23 19:48:46,166 INFO org.springframework.boot.StartupInfoLogger [main] Starting AskApiIntegrationEsignWSOFFTest using Java 11.0.2 on NXQLX078 with PID 13992 (started by cjuillard in C:\Users\cjuillard\test\esignsantepsc)
2021-12-23 19:48:46,167 DEBUG org.springframework.boot.StartupInfoLogger [main] Running with Spring Boot v2.5.2, Spring v5.3.8
2021-12-23 19:48:46,169 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-12-23 19:48:46,947 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-23 19:48:46,949 INFO fr.ans.api.sign.esignsante.psc.config.MongoDBConfig [main] création d'une connexion à MongoDB avec   mongodb://localhost:27017 mongoDatabase: esignsante-psc
2021-12-23 19:48:46,952 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c4c48ef118145e37745b9c', description='null'}-localhost:27017] Opened connection [connectionId{localValue:6, serverValue:5}] to localhost:27017
2021-12-23 19:48:46,953 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c4c48ef118145e37745b9c', description='null'}-localhost:27017] Opened connection [connectionId{localValue:5, serverValue:6}] to localhost:27017
2021-12-23 19:48:46,954 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c4c48ef118145e37745b9c', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=1997100}
2021-12-23 19:48:48,189 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-23 19:48:48,195 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c4c490f118145e37745b9d', description='null'}-localhost:27017] Opened connection [connectionId{localValue:8, serverValue:7}] to localhost:27017
2021-12-23 19:48:48,197 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c4c490f118145e37745b9d', description='null'}-localhost:27017] Opened connection [connectionId{localValue:7, serverValue:8}] to localhost:27017
2021-12-23 19:48:48,198 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c4c490f118145e37745b9d', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=3436000}
2021-12-23 19:48:48,481 INFO org.springframework.boot.StartupInfoLogger [main] Started AskApiIntegrationEsignWSOFFTest in 2.405 seconds (JVM running for 12.06)
2021-12-23 19:48:48,618 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Réception d'une demande de signature Xades
2021-12-23 19:48:48,622 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
}
2021-12-23 19:48:48,646 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  200 OK
2021-12-23 19:48:48,647 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel PSC intropesction: token= accessTokenValue  reponse PSC = {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-23 19:48:48,650 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: ipsfra.xml. Use ipsfra.xml as name
2021-12-23 19:48:48,651 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile ipsfra.xml8658916354798851480.tmp
2021-12-23 19:48:48,657 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: ipsfra.xml8658916354798851480.tmp 	 length 2628
2021-12-23 19:48:48,722 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Verification du fichier ipsfra.xml8658916354798851480.tmp type detecté: text/plain
2021-12-23 19:48:48,722 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Demande de signature valide: verif AccessToken OK: {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
, File OK ipsfra.xml8658916354798851480.tmp 
, userInfo OK Organisation: CABINET M SPECIALISTE0021889
2021-12-23 19:48:48,723 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] openidtoken[0] transmis à esignWS:
2021-12-23 19:48:48,724 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 userinfo (base64): eyJTZWN0ZXVyX0FjdGl2aXRlIjoiU0EwN14xLjIuMjUwLjEuNzEuNC4yLjQiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIlN1YmplY3RPcmdhbml6YXRpb24iOiJDQUJJTkVUIE0gU1BFQ0lBTElTVEUwMDIxODg5IiwicHJlZmVycmVkX3VzZXJuYW1lIjoiODk5NzAwMjE4ODk2IiwiZ2l2ZW5fbmFtZSI6IlJPQkVSVCIsIlN1YmplY3RSZWZQcm8iOnsiY29kZUNpdmlsaXRlIjoiTSIsImV4ZXJjaWNlcyI6W3siY29kZVByb2Zlc3Npb24iOiIxMCIsIm5vbURleGVyY2ljZSI6IlNQRUNJQUxJU1RFMDAyMTg4OSIsInByZW5vbURleGVyY2ljZSI6IlJPQkVSVCIsImNvZGVUeXBlU2F2b2lyRmFpcmUiOiIifV19LCJTdWJqZWN0Um9sZSI6WyIxMF4xLjIuMjUwLjEuMjEzLjEuMS41LjUiXSwiU3ViamVjdE5hbWVJRCI6Ijg5OTcwMDIxODg5NiIsImZhbWlseV9uYW1lIjoiU1BFQ0lBTElTVEUwMDIxODg5In0= 
2021-12-23 19:48:48,725 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 accessToken: accessTokenValue 
2021-12-23 19:48:48,726 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 PSCResponse: {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-23 19:48:48,726 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] signer: Délégataire de signature pour SPECIALISTE0021889 (899700218896)
2021-12-23 19:48:48,728 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel esignWS pour une signature de type XADES
2021-12-23 19:48:48,752 INFO fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] Appel esignante Webservices pour basePath = http://localhost:8081/esignsante/v1
2021-12-23 19:48:48,753 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] appel esignsanteWebservices pour une demande de signature en xades 
2021-12-23 19:48:48,753 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] fileToSign: ipsfra.xml8658916354798851480.tmp
2021-12-23 19:48:48,756 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] paramètres: basePath: http://localhost:8081/esignsante/v1 
 idSignConf: 1 
 proofConfId: 1 

2021-12-23 19:48:50,873 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Requête en echec. Message retourné à l'utilisateur: Exception sur appel esignWS. Service inaccessible
2021-12-23 19:48:50,875 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] classe Exception: org.springframework.web.client.ResourceAccessException
2021-12-23 19:48:50,887 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] cause de l'eException: {}
java.net.ConnectException: Connection refused: connect
	at java.base/java.net.PlainSocketImpl.connect0(Native Method)
	at java.base/java.net.PlainSocketImpl.socketConnect(PlainSocketImpl.java:101)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:399)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:242)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:224)
	at java.base/java.net.Socket.connect(Socket.java:591)
	at java.base/java.net.Socket.connect(Socket.java:540)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:182)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:474)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:569)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:242)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:341)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:362)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1242)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1181)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1075)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1009)
	at org.springframework.http.client.SimpleBufferingClientHttpRequest.executeInternal(SimpleBufferingClientHttpRequest.java:76)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.http.client.BufferingClientHttpRequestWrapper.executeInternal(BufferingClientHttpRequestWrapper.java:63)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:776)
	at org.springframework.web.client.RestTemplate.exchange(RestTemplate.java:670)
	at fr.ans.esignsante.ApiClient.invokeAPI(ApiClient.java:526)
	at fr.ans.esignsante.api.XadesApi.signatureXadesWithProof(XadesApi.java:207)
	at fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall.signatureXades(EsignsanteCall.java:56)
	at fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl.executeAskSignature(AsksignatureApiDelegateImpl.java:288)
	at fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl.postAsksignatureXades(AsksignatureApiDelegateImpl.java:129)
	at fr.ans.api.sign.esignsante.psc.api.AsksignatureApi.postAsksignatureXades(AsksignatureApi.java:91)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:894)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1063)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:681)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at org.springframework.test.web.servlet.TestDispatcherServlet.service(TestDispatcherServlet.java:72)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
	at org.springframework.mock.web.MockFilterChain$ServletFilterProxy.doFilter(MockFilterChain.java:167)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:134)
	at org.springframework.test.web.servlet.MockMvc.perform(MockMvc.java:183)
	at fr.ans.api.sign.esignsante.psc.api.requests.AskApiIntegrationEsignWSOFFTest.askSignXADES_esignWS_OFFTest(AskApiIntegrationEsignWSOFFTest.java:93)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:688)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:140)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:84)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$6(TestMethodTestDescriptor.java:210)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:206)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:131)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:65)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1540)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1540)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:32)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:51)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:220)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$6(DefaultLauncher.java:188)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:202)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:181)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:128)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:150)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2021-12-23 19:48:50,895 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] message de l'exception I/O error on POST request for "http://localhost:8081/esignsante/v1/signatures/xadesbaselinebwithproof": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect
2021-12-23 19:48:51,003 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Réception d'une demande de signature Pades
2021-12-23 19:48:51,004 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
}
2021-12-23 19:48:51,006 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  200 OK
2021-12-23 19:48:51,007 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel PSC intropesction: token= accessTokenValue  reponse PSC = {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-23 19:48:51,008 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: ANS.pdf. Use ANS.pdf as name
2021-12-23 19:48:51,009 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile ANS.pdf12867419279386546704.tmp
2021-12-23 19:48:51,013 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: ANS.pdf12867419279386546704.tmp 	 length 97996
2021-12-23 19:48:51,051 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Verification du fichier ANS.pdf12867419279386546704.tmp type detecté: application/pdf
2021-12-23 19:48:51,052 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Demande de signature valide: verif AccessToken OK: {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
, File OK ANS.pdf12867419279386546704.tmp 
, userInfo OK Organisation: CABINET M SPECIALISTE0021889
2021-12-23 19:48:51,053 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] openidtoken[0] transmis à esignWS:
2021-12-23 19:48:51,054 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 userinfo (base64): eyJTZWN0ZXVyX0FjdGl2aXRlIjoiU0EwN14xLjIuMjUwLjEuNzEuNC4yLjQiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIlN1YmplY3RPcmdhbml6YXRpb24iOiJDQUJJTkVUIE0gU1BFQ0lBTElTVEUwMDIxODg5IiwicHJlZmVycmVkX3VzZXJuYW1lIjoiODk5NzAwMjE4ODk2IiwiZ2l2ZW5fbmFtZSI6IlJPQkVSVCIsIlN1YmplY3RSZWZQcm8iOnsiY29kZUNpdmlsaXRlIjoiTSIsImV4ZXJjaWNlcyI6W3siY29kZVByb2Zlc3Npb24iOiIxMCIsIm5vbURleGVyY2ljZSI6IlNQRUNJQUxJU1RFMDAyMTg4OSIsInByZW5vbURleGVyY2ljZSI6IlJPQkVSVCIsImNvZGVUeXBlU2F2b2lyRmFpcmUiOiIifV19LCJTdWJqZWN0Um9sZSI6WyIxMF4xLjIuMjUwLjEuMjEzLjEuMS41LjUiXSwiU3ViamVjdE5hbWVJRCI6Ijg5OTcwMDIxODg5NiIsImZhbWlseV9uYW1lIjoiU1BFQ0lBTElTVEUwMDIxODg5In0= 
2021-12-23 19:48:51,055 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 accessToken: accessTokenValue 
2021-12-23 19:48:51,055 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 PSCResponse: {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-23 19:48:51,056 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] signer: Signé pour le compte de SPECIALISTE0021889 (899700218896)
2021-12-23 19:48:51,057 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel esignWS pour une signature de type PADES
2021-12-23 19:48:51,068 INFO fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] Appel esignante Webservices pour basePath = http://localhost:8081/esignsante/v1
2021-12-23 19:48:51,069 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] appel esignsanteWebservices pour une demande de signature en PADES 
2021-12-23 19:48:51,069 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] fileToSign: ANS.pdf12867419279386546704.tmp
2021-12-23 19:48:51,072 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] paramètres: basePath: http://localhost:8081/esignsante/v1 
 idSignConf: 1 
 proofConfId: 1 

2021-12-23 19:48:53,115 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Requête en echec. Message retourné à l'utilisateur: Exception sur appel esignWS. Service inaccessible
2021-12-23 19:48:53,117 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] classe Exception: org.springframework.web.client.ResourceAccessException
2021-12-23 19:48:53,120 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] cause de l'eException: {}
java.net.ConnectException: Connection refused: connect
	at java.base/java.net.PlainSocketImpl.connect0(Native Method)
	at java.base/java.net.PlainSocketImpl.socketConnect(PlainSocketImpl.java:101)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:399)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:242)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:224)
	at java.base/java.net.Socket.connect(Socket.java:591)
	at java.base/java.net.Socket.connect(Socket.java:540)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:182)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:474)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:569)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:242)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:341)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:362)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1242)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1181)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1075)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1009)
	at org.springframework.http.client.SimpleBufferingClientHttpRequest.executeInternal(SimpleBufferingClientHttpRequest.java:76)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.http.client.BufferingClientHttpRequestWrapper.executeInternal(BufferingClientHttpRequestWrapper.java:63)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:776)
	at org.springframework.web.client.RestTemplate.exchange(RestTemplate.java:670)
	at fr.ans.esignsante.ApiClient.invokeAPI(ApiClient.java:526)
	at fr.ans.esignsante.api.PadesApi.signaturePadesWithProof(PadesApi.java:207)
	at fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall.signaturePades(EsignsanteCall.java:77)
	at fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl.executeAskSignature(AsksignatureApiDelegateImpl.java:286)
	at fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl.postAskSignaturePades(AsksignatureApiDelegateImpl.java:92)
	at fr.ans.api.sign.esignsante.psc.api.AsksignatureApi.postAskSignaturePades(AsksignatureApi.java:58)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:894)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1063)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:681)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at org.springframework.test.web.servlet.TestDispatcherServlet.service(TestDispatcherServlet.java:72)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
	at org.springframework.mock.web.MockFilterChain$ServletFilterProxy.doFilter(MockFilterChain.java:167)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:134)
	at org.springframework.test.web.servlet.MockMvc.perform(MockMvc.java:183)
	at fr.ans.api.sign.esignsante.psc.api.requests.AskApiIntegrationEsignWSOFFTest.askSignPADES_esignWS_OFFTest(AskApiIntegrationEsignWSOFFTest.java:130)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:688)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:140)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:84)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$6(TestMethodTestDescriptor.java:210)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:206)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:131)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:65)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1540)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1540)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:32)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:51)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:220)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$6(DefaultLauncher.java:188)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:202)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:181)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:128)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:150)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2021-12-23 19:48:53,123 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] message de l'exception I/O error on POST request for "http://localhost:8081/esignsante/v1/signatures/padesbaselinebwithproof": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect
2021-12-23 19:48:53,249 INFO org.springframework.boot.StartupInfoLogger [main] Starting AskApiIntegrationTest using Java 11.0.2 on NXQLX078 with PID 13992 (started by cjuillard in C:\Users\cjuillard\test\esignsantepsc)
2021-12-23 19:48:53,250 DEBUG org.springframework.boot.StartupInfoLogger [main] Running with Spring Boot v2.5.2, Spring v5.3.8
2021-12-23 19:48:53,251 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-12-23 19:48:53,888 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-23 19:48:53,889 INFO fr.ans.api.sign.esignsante.psc.config.MongoDBConfig [main] création d'une connexion à MongoDB avec   mongodb://localhost:27017 mongoDatabase: esignsante-psc
2021-12-23 19:48:53,892 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c4c495f118145e37745b9e', description='null'}-localhost:27017] Opened connection [connectionId{localValue:10, serverValue:9}] to localhost:27017
2021-12-23 19:48:53,893 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c4c495f118145e37745b9e', description='null'}-localhost:27017] Opened connection [connectionId{localValue:9, serverValue:10}] to localhost:27017
2021-12-23 19:48:53,893 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c4c495f118145e37745b9e', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=1384300}
2021-12-23 19:48:54,966 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-23 19:48:54,972 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c4c496f118145e37745b9f', description='null'}-localhost:27017] Opened connection [connectionId{localValue:12, serverValue:11}] to localhost:27017
2021-12-23 19:48:54,972 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c4c496f118145e37745b9f', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=1445600}
2021-12-23 19:48:54,974 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c4c496f118145e37745b9f', description='null'}-localhost:27017] Opened connection [connectionId{localValue:11, serverValue:12}] to localhost:27017
2021-12-23 19:48:55,211 INFO org.springframework.boot.StartupInfoLogger [main] Started AskApiIntegrationTest in 1.994 seconds (JVM running for 18.79)
2021-12-23 19:48:55,226 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Réception d'une demande de signature Pades
2021-12-23 19:48:55,228 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
}
2021-12-23 19:48:55,229 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  200 OK
2021-12-23 19:48:55,230 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel PSC intropesction: token= accessTokenValue  reponse PSC = {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-23 19:48:55,232 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: ipsfra.xml. Use ipsfra.xml as name
2021-12-23 19:48:55,232 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile ipsfra.xml1657072055573017703.tmp
2021-12-23 19:48:55,233 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: ipsfra.xml1657072055573017703.tmp 	 length 2628
2021-12-23 19:48:55,243 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Verification du fichier ipsfra.xml1657072055573017703.tmp type detecté: text/plain
2021-12-23 19:48:55,292 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Réception d'une demande de signature Xades
2021-12-23 19:48:55,293 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
}
2021-12-23 19:48:55,294 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  200 OK
2021-12-23 19:48:55,295 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel PSC intropesction: token= accessTokenValue  reponse PSC = {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-23 19:48:55,297 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: ipsfra.xml. Use ipsfra.xml as name
2021-12-23 19:48:55,297 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile ipsfra.xml1984325578358295526.tmp
2021-12-23 19:48:55,299 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: ipsfra.xml1984325578358295526.tmp 	 length 2628
2021-12-23 19:48:55,309 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Verification du fichier ipsfra.xml1984325578358295526.tmp type detecté: text/plain
2021-12-23 19:48:55,310 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Demande de signature valide: verif AccessToken OK: {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
, File OK ipsfra.xml1984325578358295526.tmp 
, userInfo OK Organisation: CABINET M SPECIALISTE0021889
2021-12-23 19:48:55,310 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] openidtoken[0] transmis à esignWS:
2021-12-23 19:48:55,311 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 userinfo (base64): eyJTZWN0ZXVyX0FjdGl2aXRlIjoiU0EwN14xLjIuMjUwLjEuNzEuNC4yLjQiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIlN1YmplY3RPcmdhbml6YXRpb24iOiJDQUJJTkVUIE0gU1BFQ0lBTElTVEUwMDIxODg5IiwicHJlZmVycmVkX3VzZXJuYW1lIjoiODk5NzAwMjE4ODk2IiwiZ2l2ZW5fbmFtZSI6IlJPQkVSVCIsIlN1YmplY3RSZWZQcm8iOnsiY29kZUNpdmlsaXRlIjoiTSIsImV4ZXJjaWNlcyI6W3siY29kZVByb2Zlc3Npb24iOiIxMCIsIm5vbURleGVyY2ljZSI6IlNQRUNJQUxJU1RFMDAyMTg4OSIsInByZW5vbURleGVyY2ljZSI6IlJPQkVSVCIsImNvZGVUeXBlU2F2b2lyRmFpcmUiOiIifV19LCJTdWJqZWN0Um9sZSI6WyIxMF4xLjIuMjUwLjEuMjEzLjEuMS41LjUiXSwiU3ViamVjdE5hbWVJRCI6Ijg5OTcwMDIxODg5NiIsImZhbWlseV9uYW1lIjoiU1BFQ0lBTElTVEUwMDIxODg5In0= 
2021-12-23 19:48:55,312 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 accessToken: accessTokenValue 
2021-12-23 19:48:55,312 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 PSCResponse: {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-23 19:48:55,313 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] signer: Délégataire de signature pour SPECIALISTE0021889 (899700218896)
2021-12-23 19:48:55,314 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel esignWS pour une signature de type XADES
2021-12-23 19:48:55,315 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main]  START archivage de la preuve en BDD pour request id: 65b4bfe2-0b20-4f07-b7a0-7af113fea21e
2021-12-23 19:48:55,316 DEBUG fr.ans.api.sign.esignsante.psc.storage.repository.PreuveDAOImpl [main] demande persistence de la preuve d'une demande de signature pour: 
  SubjectOrganization: CABINET M SPECIALISTE0021889 
  Preferred_username: 899700218896 
 Given_name: ROBERT 
Family_name:SPECIALISTE0021889  
 Timestamp (acceptation de la reqête): Thu Dec 23 19:48:55 CET 2021   
2021-12-23 19:48:55,375 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Opened connection [connectionId{localValue:13, serverValue:13}] to localhost:27017
2021-12-23 19:48:55,439 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Fin archivage de la preuve en BDD pour request id: 65b4bfe2-0b20-4f07-b7a0-7af113fea21e
2021-12-23 19:48:55,507 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Réception d'une demande de signature Pades
2021-12-23 19:48:55,509 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {
    "active": false
}
2021-12-23 19:48:55,510 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  401 UNAUTHORIZED
2021-12-23 19:48:55,510 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel PSC intropesction: token= accessTokenValue  reponse PSC = {
    "active": false
} 
2021-12-23 19:48:55,548 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Réception d'une demande de signature Xades
2021-12-23 19:48:55,550 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {
    "active": false
}
2021-12-23 19:48:55,552 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  401 UNAUTHORIZED
2021-12-23 19:48:55,553 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel PSC intropesction: token= accessTokenValue  reponse PSC = {
    "active": false
} 
2021-12-23 19:48:55,584 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Réception d'une demande de signature Pades
2021-12-23 19:48:55,585 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
}
2021-12-23 19:48:55,586 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  200 OK
2021-12-23 19:48:55,587 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel PSC intropesction: token= accessTokenValue  reponse PSC = {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-23 19:48:55,588 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: ANS.pdf. Use ANS.pdf as name
2021-12-23 19:48:55,589 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile ANS.pdf16808481060133775026.tmp
2021-12-23 19:48:55,594 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: ANS.pdf16808481060133775026.tmp 	 length 97996
2021-12-23 19:48:55,638 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Verification du fichier ANS.pdf16808481060133775026.tmp type detecté: application/pdf
2021-12-23 19:48:55,638 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Demande de signature valide: verif AccessToken OK: {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
, File OK ANS.pdf16808481060133775026.tmp 
, userInfo OK Organisation: CABINET M SPECIALISTE0021889
2021-12-23 19:48:55,639 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] openidtoken[0] transmis à esignWS:
2021-12-23 19:48:55,640 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 userinfo (base64): eyJTZWN0ZXVyX0FjdGl2aXRlIjoiU0EwN14xLjIuMjUwLjEuNzEuNC4yLjQiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIlN1YmplY3RPcmdhbml6YXRpb24iOiJDQUJJTkVUIE0gU1BFQ0lBTElTVEUwMDIxODg5IiwicHJlZmVycmVkX3VzZXJuYW1lIjoiODk5NzAwMjE4ODk2IiwiZ2l2ZW5fbmFtZSI6IlJPQkVSVCIsIlN1YmplY3RSZWZQcm8iOnsiY29kZUNpdmlsaXRlIjoiTSIsImV4ZXJjaWNlcyI6W3siY29kZVByb2Zlc3Npb24iOiIxMCIsIm5vbURleGVyY2ljZSI6IlNQRUNJQUxJU1RFMDAyMTg4OSIsInByZW5vbURleGVyY2ljZSI6IlJPQkVSVCIsImNvZGVUeXBlU2F2b2lyRmFpcmUiOiIifV19LCJTdWJqZWN0Um9sZSI6WyIxMF4xLjIuMjUwLjEuMjEzLjEuMS41LjUiXSwiU3ViamVjdE5hbWVJRCI6Ijg5OTcwMDIxODg5NiIsImZhbWlseV9uYW1lIjoiU1BFQ0lBTElTVEUwMDIxODg5In0= 
2021-12-23 19:48:55,641 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 accessToken: accessTokenValue 
2021-12-23 19:48:55,641 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] 	 PSCResponse: {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
} 
2021-12-23 19:48:55,642 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] signer: Signé pour le compte de SPECIALISTE0021889 (899700218896)
2021-12-23 19:48:55,643 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Appel esignWS pour une signature de type PADES
2021-12-23 19:48:55,643 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main]  START archivage de la preuve en BDD pour request id: f26d6272-36c9-4de8-8e7e-008d85a9e755
2021-12-23 19:48:55,644 DEBUG fr.ans.api.sign.esignsante.psc.storage.repository.PreuveDAOImpl [main] demande persistence de la preuve d'une demande de signature pour: 
  SubjectOrganization: CABINET M SPECIALISTE0021889 
  Preferred_username: 899700218896 
 Given_name: ROBERT 
Family_name:SPECIALISTE0021889  
 Timestamp (acceptation de la reqête): Thu Dec 23 19:48:55 CET 2021   
2021-12-23 19:48:55,648 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AsksignatureApiDelegateImpl [main] Fin archivage de la preuve en BDD pour request id: f26d6272-36c9-4de8-8e7e-008d85a9e755
2021-12-23 19:48:55,694 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Réception d'une demande des CAs
2021-12-23 19:48:55,702 INFO fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] Appel esignante Webservices pour basePath = http://localhost:8081/esignsante/v1
2021-12-23 19:48:57,724 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] Requête en echec. Message retourné à l'utilisateur: Exception sur appel esignWS. Service inaccessible
2021-12-23 19:48:57,726 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] classe Exception: org.springframework.web.client.ResourceAccessException
2021-12-23 19:48:57,728 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] cause de l'eException: {}
java.net.ConnectException: Connection refused: connect
	at java.base/java.net.PlainSocketImpl.connect0(Native Method)
	at java.base/java.net.PlainSocketImpl.socketConnect(PlainSocketImpl.java:101)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:399)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:242)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:224)
	at java.base/java.net.Socket.connect(Socket.java:591)
	at java.base/java.net.Socket.connect(Socket.java:540)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:182)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:474)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:569)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:242)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:341)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:362)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1242)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1181)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1075)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1009)
	at org.springframework.http.client.SimpleBufferingClientHttpRequest.executeInternal(SimpleBufferingClientHttpRequest.java:76)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.http.client.BufferingClientHttpRequestWrapper.executeInternal(BufferingClientHttpRequestWrapper.java:63)
	at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)
	at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:66)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:776)
	at org.springframework.web.client.RestTemplate.exchange(RestTemplate.java:670)
	at fr.ans.esignsante.ApiClient.invokeAPI(ApiClient.java:526)
	at fr.ans.esignsante.api.CaApi.getCA(CaApi.java:73)
	at fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall.getCA(EsignsanteCall.java:124)
	at fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl.getCa(CaApiDelegateImpl.java:40)
	at fr.ans.api.sign.esignsante.psc.api.CaApi.getCa(CaApi.java:46)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:894)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1063)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:898)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:655)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)
	at org.springframework.test.web.servlet.TestDispatcherServlet.service(TestDispatcherServlet.java:72)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764)
	at org.springframework.mock.web.MockFilterChain$ServletFilterProxy.doFilter(MockFilterChain.java:167)
	at org.springframework.mock.web.MockFilterChain.doFilter(MockFilterChain.java:134)
	at org.springframework.test.web.servlet.MockMvc.perform(MockMvc.java:183)
	at fr.ans.api.sign.esignsante.psc.api.requests.CAApiIntegrationEsignWSOFFTest.caGet_esignWS_OFFTest(CAApiIntegrationEsignWSOFFTest.java:52)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:688)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:140)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:84)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$6(TestMethodTestDescriptor.java:210)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:206)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:131)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:65)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1540)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1540)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:32)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:51)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:220)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$6(DefaultLauncher.java:188)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:202)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:181)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:128)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:150)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2021-12-23 19:48:57,730 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] message de l'exception I/O error on GET request for "http://localhost:8081/esignsante/v1/ca": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect
2021-12-23 19:48:57,813 INFO org.springframework.boot.StartupInfoLogger [main] Starting CAApiIntegrationTest using Java 11.0.2 on NXQLX078 with PID 13992 (started by cjuillard in C:\Users\cjuillard\test\esignsantepsc)
2021-12-23 19:48:57,813 DEBUG org.springframework.boot.StartupInfoLogger [main] Running with Spring Boot v2.5.2, Spring v5.3.8
2021-12-23 19:48:57,814 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-12-23 19:48:58,428 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-23 19:48:58,429 INFO fr.ans.api.sign.esignsante.psc.config.MongoDBConfig [main] création d'une connexion à MongoDB avec   mongodb://localhost:27017 mongoDatabase: esignsante-psc
2021-12-23 19:48:58,432 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c4c49af118145e37745ba2', description='null'}-localhost:27017] Opened connection [connectionId{localValue:15, serverValue:14}] to localhost:27017
2021-12-23 19:48:58,433 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c4c49af118145e37745ba2', description='null'}-localhost:27017] Opened connection [connectionId{localValue:14, serverValue:15}] to localhost:27017
2021-12-23 19:48:58,434 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c4c49af118145e37745ba2', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=2214500}
2021-12-23 19:48:59,396 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-23 19:48:59,403 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c4c49bf118145e37745ba3', description='null'}-localhost:27017] Opened connection [connectionId{localValue:17, serverValue:16}] to localhost:27017
2021-12-23 19:48:59,406 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c4c49bf118145e37745ba3', description='null'}-localhost:27017] Opened connection [connectionId{localValue:16, serverValue:17}] to localhost:27017
2021-12-23 19:48:59,406 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c4c49bf118145e37745ba3', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=4478600}
2021-12-23 19:48:59,615 INFO org.springframework.boot.StartupInfoLogger [main] Started CAApiIntegrationTest in 1.84 seconds (JVM running for 23.194)
2021-12-23 19:48:59,646 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Réception d'une demande des CAs
2021-12-23 19:48:59,646 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Demande des CAs traitée avec succès
2021-12-23 19:48:59,668 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Réception d'une demande des CAs
2021-12-23 19:48:59,670 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Demande des CAs traitée avec succès
2021-12-23 19:48:59,673 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Réception d'une demande des CAs
2021-12-23 19:48:59,674 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Demande des CAs traitée avec succès
2021-12-23 19:48:59,676 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Réception d'une demande des CAs
2021-12-23 19:48:59,678 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Demande des CAs traitée avec succès
2021-12-23 19:48:59,686 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Réception d'une demande des CAs
2021-12-23 19:48:59,688 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Demande des CAs traitée avec succès
2021-12-23 19:48:59,705 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Réception d'une demande des CAs
2021-12-23 19:48:59,706 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.CaApiDelegateImpl [main]  Demande des CAs traitée avec succès
2021-12-23 19:48:59,743 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Demande Checksignature Pades reçue
2021-12-23 19:48:59,745 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: signedipsfra.xml. Use signedipsfra.xml as name
2021-12-23 19:48:59,746 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile signedipsfra.xml8955531014001038743.tmp
2021-12-23 19:48:59,747 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: signedipsfra.xml8955531014001038743.tmp 	 length 10239
2021-12-23 19:48:59,749 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] message 501 501 

2021-12-23 19:48:59,749 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] toString org.springframework.web.client.HttpServerErrorException$NotImplemented: 501 501 

2021-12-23 19:48:59,750 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] class Name org.springframework.web.client.HttpServerErrorException$NotImplemented 

2021-12-23 19:48:59,751 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] class Canonicalname org.springframework.web.client.HttpServerErrorException.NotImplemented 

2021-12-23 19:48:59,751 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Echec de l'appel à esignsanteWS => HttpServerErrorException.NotImplemented
2021-12-23 19:48:59,782 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Réception d'une demande Checksignature Pades.
2021-12-23 19:48:59,783 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: ANS_SIGNED.pdf. Use ANS_SIGNED.pdf as name
2021-12-23 19:48:59,784 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile ANS_SIGNED.pdf11087032687882262128.tmp
2021-12-23 19:48:59,786 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: ANS_SIGNED.pdf11087032687882262128.tmp 	 length 118076
2021-12-23 19:48:59,788 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] message 501 501 

2021-12-23 19:48:59,789 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] toString org.springframework.web.client.HttpServerErrorException$NotImplemented: 501 501 

2021-12-23 19:48:59,790 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] class Name org.springframework.web.client.HttpServerErrorException$NotImplemented 

2021-12-23 19:48:59,790 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] class Canonicalname org.springframework.web.client.HttpServerErrorException.NotImplemented 

2021-12-23 19:48:59,791 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Echec de l'appel à esignsanteWS => HttpServerErrorException.NotImplemented
2021-12-23 19:48:59,844 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Réception d'une demande Checksignature Pades.
2021-12-23 19:48:59,846 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: . Use  as name
2021-12-23 19:48:59,847 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile 17060716994278183841.tmp
2021-12-23 19:48:59,849 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: 17060716994278183841.tmp 	 length 32158
2021-12-23 19:48:59,858 INFO fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] Appel esignante Webservices pour basePath = http://localhost:8081/esignsante/v1
2021-12-23 19:48:59,858 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] appel esignsanteWebservices pour une VERIF de signature en xades
2021-12-23 19:48:59,868 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] paramètres: basePath: http://localhost:8081/esignsante/v1 id checkSign d esignsante: 1 file: 17060716994278183841.tmp
2021-12-23 19:48:59,870 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] fileExist:true
2021-12-23 19:49:01,936 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] message I/O error on POST request for "http://localhost:8081/esignsante/v1/validation/signatures/xadesbaselineb": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect 

2021-12-23 19:49:01,938 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] toString org.springframework.web.client.ResourceAccessException: I/O error on POST request for "http://localhost:8081/esignsante/v1/validation/signatures/xadesbaselineb": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect 

2021-12-23 19:49:01,939 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] class Name org.springframework.web.client.ResourceAccessException 

2021-12-23 19:49:01,941 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] class Canonicalname org.springframework.web.client.ResourceAccessException 

2021-12-23 19:49:01,942 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Exception sur appel esignWS. Service inaccessible
2021-12-23 19:49:02,018 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Demande Checksignature Pades reçue
2021-12-23 19:49:02,019 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: . Use  as name
2021-12-23 19:49:02,020 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile 15138948488479325048.tmp
2021-12-23 19:49:02,022 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: 15138948488479325048.tmp 	 length 118076
2021-12-23 19:49:02,028 INFO fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] Appel esignante Webservices pour basePath = http://localhost:8081/esignsante/v1
2021-12-23 19:49:02,028 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] appel esignsanteWebservices pour une VERIF de signature en PADES
2021-12-23 19:49:02,029 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] paramètres: basePath: http://localhost:8081/esignsante/v1 id checkSign d esignsante: 1 file: 15138948488479325048.tmp
2021-12-23 19:49:02,029 DEBUG fr.ans.api.sign.esignsante.psc.esignsantewebservices.call.EsignsanteCall [main] fileExist:true
2021-12-23 19:49:04,086 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] message I/O error on POST request for "http://localhost:8081/esignsante/v1/validation/signatures/padesbaselineb": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect 

2021-12-23 19:49:04,088 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] toString org.springframework.web.client.ResourceAccessException: I/O error on POST request for "http://localhost:8081/esignsante/v1/validation/signatures/padesbaselineb": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect 

2021-12-23 19:49:04,089 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] class Name org.springframework.web.client.ResourceAccessException 

2021-12-23 19:49:04,090 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] class Canonicalname org.springframework.web.client.ResourceAccessException 

2021-12-23 19:49:04,091 ERROR fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Exception sur appel esignWS. Service inaccessible
2021-12-23 19:49:04,175 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Demande Checksignature Pades reçue
2021-12-23 19:49:04,176 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: ANS_SIGNED.pdf. Use ANS_SIGNED.pdf as name
2021-12-23 19:49:04,176 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile ANS_SIGNED.pdf11487152226297453719.tmp
2021-12-23 19:49:04,179 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: ANS_SIGNED.pdf11487152226297453719.tmp 	 length 118076
2021-12-23 19:49:04,179 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] retour appel esignsante OK pour un contrôle de signature - formatage de la réponse
2021-12-23 19:49:04,180 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] report true
2021-12-23 19:49:04,207 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] Réception d'une demande Checksignature Pades.
2021-12-23 19:49:04,209 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main]  multipart.getOriginalFilename: signedipsfra.xml. Use signedipsfra.xml as name
2021-12-23 19:49:04,209 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] tempFile signedipsfra.xml10719879453618813080.tmp
2021-12-23 19:49:04,211 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.AbstractApiDelegate [main] fileToCheck isFile: true 	 name: signedipsfra.xml10719879453618813080.tmp 	 length 10239
2021-12-23 19:49:04,212 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] retour appel esignsante OK pour un contrôle de signature - formatage de la réponse
2021-12-23 19:49:04,212 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.ChecksignatureApiDelegateImpl [main] report true
2021-12-23 19:49:04,242 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.DefaultApiDelegateImpl [main] Réception d'une demande des opérations disponibles
2021-12-23 19:49:04,266 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.DefaultApiDelegateImpl [main] Réception d'une demande des opérations disponibles
2021-12-23 19:49:04,323 DEBUG fr.ans.api.sign.esignsante.psc.api.delegate.DefaultApiDelegateImpl [main] Réception d'une demande des opérations disponibles
2021-12-23 19:49:04,395 INFO org.springframework.boot.StartupInfoLogger [main] Starting HelperTest using Java 11.0.2 on NXQLX078 with PID 13992 (started by cjuillard in C:\Users\cjuillard\test\esignsantepsc)
2021-12-23 19:49:04,396 DEBUG org.springframework.boot.StartupInfoLogger [main] Running with Spring Boot v2.5.2, Spring v5.3.8
2021-12-23 19:49:04,397 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-12-23 19:49:05,122 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-23 19:49:05,124 INFO fr.ans.api.sign.esignsante.psc.config.MongoDBConfig [main] création d'une connexion à MongoDB avec   mongodb://localhost:27017 mongoDatabase: esignsante-psc
2021-12-23 19:49:05,128 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c4c4a1f118145e37745ba4', description='null'}-localhost:27017] Opened connection [connectionId{localValue:19, serverValue:18}] to localhost:27017
2021-12-23 19:49:05,128 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c4c4a1f118145e37745ba4', description='null'}-localhost:27017] Opened connection [connectionId{localValue:18, serverValue:19}] to localhost:27017
2021-12-23 19:49:05,129 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c4c4a1f118145e37745ba4', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=2463800}
2021-12-23 19:49:05,977 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-23 19:49:05,981 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c4c4a1f118145e37745ba5', description='null'}-localhost:27017] Opened connection [connectionId{localValue:20, serverValue:20}] to localhost:27017
2021-12-23 19:49:05,981 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c4c4a1f118145e37745ba5', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=876500}
2021-12-23 19:49:05,982 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c4c4a1f118145e37745ba5', description='null'}-localhost:27017] Opened connection [connectionId{localValue:21, serverValue:21}] to localhost:27017
2021-12-23 19:49:06,190 INFO org.springframework.boot.StartupInfoLogger [main] Started HelperTest in 1.838 seconds (JVM running for 29.77)
2021-12-23 19:49:06,200 DEBUG fr.ans.api.sign.esignsante.psc.api.utils.HelperTest [main] encodebase64
2021-12-23 19:49:06,200 DEBUG fr.ans.api.sign.esignsante.psc.api.utils.HelperTest [main] Q2hhw65uZSBkZSBjYXJhY3TDqHJlIFVURjggJsOpIigsOyE=
2021-12-23 19:49:06,209 DEBUG fr.ans.api.sign.esignsante.psc.api.utils.HelperTest [main] test conversion Erreur(esignsante) en Error (esigsante-psc
2021-12-23 19:49:06,211 DEBUG fr.ans.api.sign.esignsante.psc.api.utils.HelperTest [main] code :codeErreur1 msg :message1
2021-12-23 19:49:06,211 DEBUG fr.ans.api.sign.esignsante.psc.api.utils.HelperTest [main] code :codeErreur2 msg :message2
2021-12-23 19:49:06,222 DEBUG fr.ans.api.sign.esignsante.psc.api.utils.HelperTest [main] decodebase64
2021-12-23 19:49:06,223 DEBUG fr.ans.api.sign.esignsante.psc.api.utils.HelperTest [main] Chaîne de caractère UTF8 &é"(,;!
2021-12-23 19:49:06,228 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {
    "exp": 1628250495,
    "iat": 1628250435,
    "auth_time": 1628250434,
    "jti": "0cc00f99-3f1b-4799-9222-a944ca82c310",
    "iss": "https://auth.bas.esw.esante.gouv.fr/auth/realms/esante-wallet",
    "sub": "f:550dc1c8-d97b-4b1e-ac8c-8eb4471cf9dd:899700218896",
    "typ": "Bearer",
    "azp": "ans-poc-bas-psc",
    "nonce": "",
    "session_state": "e0e82435-fef5-430b-9b31-187fe3b0ffe6",
    "preferred_username": "899700218896",
    "email_verified": false,
    "acr": "eidas3",
    "scope": "openid profile email scope_all",
    "client_id": "ans-poc-bas-psc",
    "username": "899700218896",
    "active": true
}
2021-12-23 19:49:06,228 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  200 OK
2021-12-23 19:49:06,229 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with {"active":false}
2021-12-23 19:49:06,229 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  401 UNAUTHORIZED
2021-12-23 19:49:06,230 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse IN with Mauvaise réponse..
2021-12-23 19:49:06,231 ERROR fr.ans.api.sign.esignsante.psc.utils.Helper [main] Erreur technique durant le parse de la reponse d'intropection PSC: champ Unrecognized token 'Mauvaise': was expecting (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (String)"Mauvaise réponse.."; line: 1, column: 9] 
2021-12-23 19:49:06,232 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] com.fasterxml.jackson.core.JsonParseException: Unrecognized token 'Mauvaise': was expecting (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (String)"Mauvaise réponse.."; line: 1, column: 9]
2021-12-23 19:49:06,232 DEBUG fr.ans.api.sign.esignsante.psc.utils.Helper [main] parsePSCresponse OUT status =  500 INTERNAL_SERVER_ERROR
2021-12-23 19:49:06,288 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Opened connection [connectionId{localValue:22, serverValue:22}] to localhost:27017
2021-12-23 19:49:06,296 INFO fr.ans.api.sign.esignsante.psc.storage.MongoDbTest [main] *** Test d'écriture ProofStorage dans MongoDB
2021-12-23 19:49:06,297 INFO fr.ans.api.sign.esignsante.psc.storage.MongoDbTest [main] nom de base utilisée => esignsante-psc
2021-12-23 19:49:06,381 INFO fr.ans.api.sign.esignsante.psc.storage.MongoDbTest [main] Recherche de la preuve stokée id_bdd: 61c4c4a2f118145e37745ba6
2021-12-23 19:49:06,386 INFO fr.ans.api.sign.esignsante.psc.storage.MongoDbTest [main] Test stokage recherche en BDD OK
2021-12-23 19:49:06,430 INFO org.springframework.boot.StartupInfoLogger [main] Starting EsignsantePscApplicationTest using Java 11.0.2 on NXQLX078 with PID 13992 (started by cjuillard in C:\Users\cjuillard\test\esignsantepsc)
2021-12-23 19:49:06,430 DEBUG org.springframework.boot.StartupInfoLogger [main] Running with Spring Boot v2.5.2, Spring v5.3.8
2021-12-23 19:49:06,431 INFO org.springframework.boot.SpringApplication [main] No active profile set, falling back to default profiles: default
2021-12-23 19:49:06,967 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-23 19:49:06,968 INFO fr.ans.api.sign.esignsante.psc.config.MongoDBConfig [main] création d'une connexion à MongoDB avec   mongodb://localhost:27017 mongoDatabase: esignsante-psc
2021-12-23 19:49:06,970 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c4c4a2f118145e37745ba7', description='null'}-localhost:27017] Opened connection [connectionId{localValue:24, serverValue:23}] to localhost:27017
2021-12-23 19:49:06,971 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c4c4a2f118145e37745ba7', description='null'}-localhost:27017] Opened connection [connectionId{localValue:23, serverValue:24}] to localhost:27017
2021-12-23 19:49:06,972 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c4c4a2f118145e37745ba7', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=1047200}
2021-12-23 19:49:07,839 INFO com.mongodb.diagnostics.logging.SLF4JLogger [main] Cluster created with settings {hosts=[localhost:27017], mode=SINGLE, requiredClusterType=UNKNOWN, serverSelectionTimeout='30000 ms'}
2021-12-23 19:49:07,843 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-rtt-ClusterId{value='61c4c4a3f118145e37745ba8', description='null'}-localhost:27017] Opened connection [connectionId{localValue:26, serverValue:25}] to localhost:27017
2021-12-23 19:49:07,843 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c4c4a3f118145e37745ba8', description='null'}-localhost:27017] Opened connection [connectionId{localValue:25, serverValue:26}] to localhost:27017
2021-12-23 19:49:07,843 INFO com.mongodb.diagnostics.logging.SLF4JLogger [cluster-ClusterId{value='61c4c4a3f118145e37745ba8', description='null'}-localhost:27017] Monitor thread successfully connected to server with description ServerDescription{address=localhost:27017, type=STANDALONE, state=CONNECTED, ok=true, minWireVersion=0, maxWireVersion=5, maxDocumentSize=16777216, logicalSessionTimeoutMinutes=null, roundTripTimeNanos=1213300}
2021-12-23 19:49:08,032 INFO org.springframework.boot.StartupInfoLogger [main] Started EsignsantePscApplicationTest in 1.626 seconds (JVM running for 31.611)
